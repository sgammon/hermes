<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>lib.gflags &mdash; Hermes v2.0 Docs</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5-alpha-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Hermes v2.0 Docs"
          href="../../_static/opensearch.xml"/>
    <link rel="top" title="Hermes v2.0 Docs" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Hermes</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for lib.gflags</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/env python</span>
<span class="c">#</span>
<span class="c"># Copyright (c) 2002, Google Inc.</span>
<span class="c"># All rights reserved.</span>
<span class="c">#</span>
<span class="c"># Redistribution and use in source and binary forms, with or without</span>
<span class="c"># modification, are permitted provided that the following conditions are</span>
<span class="c"># met:</span>
<span class="c">#</span>
<span class="c">#     * Redistributions of source code must retain the above copyright</span>
<span class="c"># notice, this list of conditions and the following disclaimer.</span>
<span class="c">#     * Redistributions in binary form must reproduce the above</span>
<span class="c"># copyright notice, this list of conditions and the following disclaimer</span>
<span class="c"># in the documentation and/or other materials provided with the</span>
<span class="c"># distribution.</span>
<span class="c">#     * Neither the name of Google Inc. nor the names of its</span>
<span class="c"># contributors may be used to endorse or promote products derived from</span>
<span class="c"># this software without specific prior written permission.</span>
<span class="c">#</span>
<span class="c"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="c"># &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="c"># LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="c"># A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="c"># OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="c"># SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="c"># LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="c"># DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="c"># THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="c"># (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c">#</span>
<span class="c"># ---</span>
<span class="c"># Author: Chad Lester</span>
<span class="c"># Design and style contributions by:</span>
<span class="c">#   Amit Patel, Bogdan Cocosel, Daniel Dulitz, Eric Tiedemann,</span>
<span class="c">#   Eric Veach, Laurence Gonsalves, Matthew Springer</span>
<span class="c"># Code reorganized a bit by Craig Silverstein</span>

<span class="sd">&quot;&quot;&quot;This module is used to define and parse command line flags.</span>

<span class="sd">This module defines a *distributed* flag-definition policy: rather than</span>
<span class="sd">an application having to define all flags in or near main(), each python</span>
<span class="sd">module defines flags that are useful to it.  When one python module</span>
<span class="sd">imports another, it gains access to the other&#39;s flags.  (This is</span>
<span class="sd">implemented by having all modules share a common, global registry object</span>
<span class="sd">containing all the flag information.)</span>

<span class="sd">Flags are defined through the use of one of the DEFINE_xxx functions.</span>
<span class="sd">The specific function used determines how the flag is parsed, checked,</span>
<span class="sd">and optionally type-converted, when it&#39;s seen on the command line.</span>


<span class="sd">IMPLEMENTATION: DEFINE_* creates a &#39;Flag&#39; object and registers it with a</span>
<span class="sd">&#39;FlagValues&#39; object (typically the global FlagValues FLAGS, defined</span>
<span class="sd">here).  The &#39;FlagValues&#39; object can scan the command line arguments and</span>
<span class="sd">pass flag arguments to the corresponding &#39;Flag&#39; objects for</span>
<span class="sd">value-checking and type conversion.  The converted flag values are</span>
<span class="sd">available as attributes of the &#39;FlagValues&#39; object.</span>

<span class="sd">Code can access the flag through a FlagValues object, for instance</span>
<span class="sd">gflags.FLAGS.myflag.  Typically, the __main__ module passes the command</span>
<span class="sd">line arguments to gflags.FLAGS for parsing.</span>

<span class="sd">At bottom, this module calls getopt(), so getopt functionality is</span>
<span class="sd">supported, including short- and long-style flags, and the use of -- to</span>
<span class="sd">terminate flags.</span>

<span class="sd">Methods defined by the flag module will throw &#39;FlagsError&#39; exceptions.</span>
<span class="sd">The exception argument will be a human-readable string.</span>


<span class="sd">FLAG TYPES: This is a list of the DEFINE_*&#39;s that you can do.  All flags</span>
<span class="sd">take a name, default value, help-string, and optional &#39;short&#39; name</span>
<span class="sd">(one-letter name).  Some flags have other arguments, which are described</span>
<span class="sd">with the flag.</span>

<span class="sd">DEFINE_string: takes any input, and interprets it as a string.</span>

<span class="sd">DEFINE_bool or</span>
<span class="sd">DEFINE_boolean: typically does not take an argument: say --myflag to</span>
<span class="sd">                set FLAGS.myflag to true, or --nomyflag to set</span>
<span class="sd">                FLAGS.myflag to false.  Alternately, you can say</span>
<span class="sd">                   --myflag=true  or --myflag=t or --myflag=1  or</span>
<span class="sd">                   --myflag=false or --myflag=f or --myflag=0</span>

<span class="sd">DEFINE_float: takes an input and interprets it as a floating point</span>
<span class="sd">              number.  Takes optional args lower_bound and upper_bound;</span>
<span class="sd">              if the number specified on the command line is out of</span>
<span class="sd">              range, it will raise a FlagError.</span>

<span class="sd">DEFINE_integer: takes an input and interprets it as an integer.  Takes</span>
<span class="sd">                optional args lower_bound and upper_bound as for floats.</span>

<span class="sd">DEFINE_enum: takes a list of strings which represents legal values.  If</span>
<span class="sd">             the command-line value is not in this list, raise a flag</span>
<span class="sd">             error.  Otherwise, assign to FLAGS.flag as a string.</span>

<span class="sd">DEFINE_list: Takes a comma-separated list of strings on the commandline.</span>
<span class="sd">             Stores them in a python list object.</span>

<span class="sd">DEFINE_spaceseplist: Takes a space-separated list of strings on the</span>
<span class="sd">                     commandline.  Stores them in a python list object.</span>
<span class="sd">                     Example: --myspacesepflag &quot;foo bar baz&quot;</span>

<span class="sd">DEFINE_multistring: The same as DEFINE_string, except the flag can be</span>
<span class="sd">                    specified more than once on the commandline.  The</span>
<span class="sd">                    result is a python list object (list of strings),</span>
<span class="sd">                    even if the flag is only on the command line once.</span>

<span class="sd">DEFINE_multi_int: The same as DEFINE_integer, except the flag can be</span>
<span class="sd">                  specified more than once on the commandline.  The</span>
<span class="sd">                  result is a python list object (list of ints), even if</span>
<span class="sd">                  the flag is only on the command line once.</span>


<span class="sd">SPECIAL FLAGS: There are a few flags that have special meaning:</span>
<span class="sd">   --help          prints a list of all the flags in a human-readable fashion</span>
<span class="sd">   --helpshort     prints a list of all key flags (see below).</span>
<span class="sd">   --helpxml       prints a list of all flags, in XML format.  DO NOT parse</span>
<span class="sd">                   the output of --help and --helpshort.  Instead, parse</span>
<span class="sd">                   the output of --helpxml.  For more info, see</span>
<span class="sd">                   &quot;OUTPUT FOR --helpxml&quot; below.</span>
<span class="sd">   --flagfile=foo  read flags from file foo.</span>
<span class="sd">   --undefok=f1,f2 ignore unrecognized option errors for f1,f2.</span>
<span class="sd">                   For boolean flags, you should use --undefok=boolflag, and</span>
<span class="sd">                   --boolflag and --noboolflag will be accepted.  Do not use</span>
<span class="sd">                   --undefok=noboolflag.</span>
<span class="sd">   --              as in getopt(), terminates flag-processing</span>


<span class="sd">FLAGS VALIDATORS: If your program:</span>
<span class="sd">  - requires flag X to be specified</span>
<span class="sd">  - needs flag Y to match a regular expression</span>
<span class="sd">  - or requires any more general constraint to be satisfied</span>
<span class="sd">then validators are for you!</span>

<span class="sd">Each validator represents a constraint over one flag, which is enforced</span>
<span class="sd">starting from the initial parsing of the flags and until the program</span>
<span class="sd">terminates.</span>

<span class="sd">Also, lower_bound and upper_bound for numerical flags are enforced using flag</span>
<span class="sd">validators.</span>

<span class="sd">Howto:</span>
<span class="sd">If you want to enforce a constraint over one flag, use</span>

<span class="sd">gflags.RegisterValidator(flag_name,</span>
<span class="sd">                        checker,</span>
<span class="sd">                        message=&#39;Flag validation failed&#39;,</span>
<span class="sd">                        flag_values=FLAGS)</span>

<span class="sd">After flag values are initially parsed, and after any change to the specified</span>
<span class="sd">flag, method checker(flag_value) will be executed. If constraint is not</span>
<span class="sd">satisfied, an IllegalFlagValue exception will be raised. See</span>
<span class="sd">RegisterValidator&#39;s docstring for a detailed explanation on how to construct</span>
<span class="sd">your own checker.</span>


<span class="sd">EXAMPLE USAGE:</span>

<span class="sd">FLAGS = gflags.FLAGS</span>

<span class="sd">gflags.DEFINE_integer(&#39;my_version&#39;, 0, &#39;Version number.&#39;)</span>
<span class="sd">gflags.DEFINE_string(&#39;filename&#39;, None, &#39;Input file name&#39;, short_name=&#39;f&#39;)</span>

<span class="sd">gflags.RegisterValidator(&#39;my_version&#39;,</span>
<span class="sd">                        lambda value: value % 2 == 0,</span>
<span class="sd">                        message=&#39;--my_version must be divisible by 2&#39;)</span>
<span class="sd">gflags.MarkFlagAsRequired(&#39;filename&#39;)</span>


<span class="sd">NOTE ON --flagfile:</span>

<span class="sd">Flags may be loaded from text files in addition to being specified on</span>
<span class="sd">the commandline.</span>

<span class="sd">Any flags you don&#39;t feel like typing, throw them in a file, one flag per</span>
<span class="sd">line, for instance:</span>
<span class="sd">   --myflag=myvalue</span>
<span class="sd">   --nomyboolean_flag</span>
<span class="sd">You then specify your file with the special flag &#39;--flagfile=somefile&#39;.</span>
<span class="sd">You CAN recursively nest flagfile= tokens OR use multiple files on the</span>
<span class="sd">command line.  Lines beginning with a single hash &#39;#&#39; or a double slash</span>
<span class="sd">&#39;//&#39; are comments in your flagfile.</span>

<span class="sd">Any flagfile=&lt;file&gt; will be interpreted as having a relative path from</span>
<span class="sd">the current working directory rather than from the place the file was</span>
<span class="sd">included from:</span>
<span class="sd">   myPythonScript.py --flagfile=config/somefile.cfg</span>

<span class="sd">If somefile.cfg includes further --flagfile= directives, these will be</span>
<span class="sd">referenced relative to the original CWD, not from the directory the</span>
<span class="sd">including flagfile was found in!</span>

<span class="sd">The caveat applies to people who are including a series of nested files</span>
<span class="sd">in a different dir than they are executing out of.  Relative path names</span>
<span class="sd">are always from CWD, not from the directory of the parent include</span>
<span class="sd">flagfile. We do now support &#39;~&#39; expanded directory names.</span>

<span class="sd">Absolute path names ALWAYS work!</span>


<span class="sd">EXAMPLE USAGE:</span>


<span class="sd">  FLAGS = gflags.FLAGS</span>

<span class="sd">  # Flag names are globally defined!  So in general, we need to be</span>
<span class="sd">  # careful to pick names that are unlikely to be used by other libraries.</span>
<span class="sd">  # If there is a conflict, we&#39;ll get an error at import time.</span>
<span class="sd">  gflags.DEFINE_string(&#39;name&#39;, &#39;Mr. President&#39;, &#39;your name&#39;)</span>
<span class="sd">  gflags.DEFINE_integer(&#39;age&#39;, None, &#39;your age in years&#39;, lower_bound=0)</span>
<span class="sd">  gflags.DEFINE_boolean(&#39;debug&#39;, False, &#39;produces debugging output&#39;)</span>
<span class="sd">  gflags.DEFINE_enum(&#39;gender&#39;, &#39;male&#39;, [&#39;male&#39;, &#39;female&#39;], &#39;your gender&#39;)</span>

<span class="sd">  def main(argv):</span>
<span class="sd">    try:</span>
<span class="sd">      argv = FLAGS(argv)  # parse flags</span>
<span class="sd">    except gflags.FlagsError, e:</span>
<span class="sd">      print &#39;%s\\nUsage: %s ARGS\\n%s&#39; % (e, sys.argv[0], FLAGS)</span>
<span class="sd">      sys.exit(1)</span>
<span class="sd">    if FLAGS.debug: print &#39;non-flag arguments:&#39;, argv</span>
<span class="sd">    print &#39;Happy Birthday&#39;, FLAGS.name</span>
<span class="sd">    if FLAGS.age is not None:</span>
<span class="sd">      print &#39;You are a %d year old %s&#39; % (FLAGS.age, FLAGS.gender)</span>

<span class="sd">  if __name__ == &#39;__main__&#39;:</span>
<span class="sd">    main(sys.argv)</span>


<span class="sd">KEY FLAGS:</span>

<span class="sd">As we already explained, each module gains access to all flags defined</span>
<span class="sd">by all the other modules it transitively imports.  In the case of</span>
<span class="sd">non-trivial scripts, this means a lot of flags ...  For documentation</span>
<span class="sd">purposes, it is good to identify the flags that are key (i.e., really</span>
<span class="sd">important) to a module.  Clearly, the concept of &quot;key flag&quot; is a</span>
<span class="sd">subjective one.  When trying to determine whether a flag is key to a</span>
<span class="sd">module or not, assume that you are trying to explain your module to a</span>
<span class="sd">potential user: which flags would you really like to mention first?</span>

<span class="sd">We&#39;ll describe shortly how to declare which flags are key to a module.</span>
<span class="sd">For the moment, assume we know the set of key flags for each module.</span>
<span class="sd">Then, if you use the app.py module, you can use the --helpshort flag to</span>
<span class="sd">print only the help for the flags that are key to the main module, in a</span>
<span class="sd">human-readable format.</span>

<span class="sd">NOTE: If you need to parse the flag help, do NOT use the output of</span>
<span class="sd">--help / --helpshort.  That output is meant for human consumption, and</span>
<span class="sd">may be changed in the future.  Instead, use --helpxml; flags that are</span>
<span class="sd">key for the main module are marked there with a &lt;key&gt;yes&lt;/key&gt; element.</span>

<span class="sd">The set of key flags for a module M is composed of:</span>

<span class="sd">1. Flags defined by module M by calling a DEFINE_* function.</span>

<span class="sd">2. Flags that module M explictly declares as key by using the function</span>

<span class="sd">     DECLARE_key_flag(&lt;flag_name&gt;)</span>

<span class="sd">3. Key flags of other modules that M specifies by using the function</span>

<span class="sd">     ADOPT_module_key_flags(&lt;other_module&gt;)</span>

<span class="sd">   This is a &quot;bulk&quot; declaration of key flags: each flag that is key for</span>
<span class="sd">   &lt;other_module&gt; becomes key for the current module too.</span>

<span class="sd">Notice that if you do not use the functions described at points 2 and 3</span>
<span class="sd">above, then --helpshort prints information only about the flags defined</span>
<span class="sd">by the main module of our script.  In many cases, this behavior is good</span>
<span class="sd">enough.  But if you move part of the main module code (together with the</span>
<span class="sd">related flags) into a different module, then it is nice to use</span>
<span class="sd">DECLARE_key_flag / ADOPT_module_key_flags and make sure --helpshort</span>
<span class="sd">lists all relevant flags (otherwise, your code refactoring may confuse</span>
<span class="sd">your users).</span>

<span class="sd">Note: each of DECLARE_key_flag / ADOPT_module_key_flags has its own</span>
<span class="sd">pluses and minuses: DECLARE_key_flag is more targeted and may lead a</span>
<span class="sd">more focused --helpshort documentation.  ADOPT_module_key_flags is good</span>
<span class="sd">for cases when an entire module is considered key to the current script.</span>
<span class="sd">Also, it does not require updates to client scripts when a new flag is</span>
<span class="sd">added to the module.</span>


<span class="sd">EXAMPLE USAGE 2 (WITH KEY FLAGS):</span>

<span class="sd">Consider an application that contains the following three files (two</span>
<span class="sd">auxiliary modules and a main module)</span>

<span class="sd">File libfoo.py:</span>

<span class="sd">  import gflags</span>

<span class="sd">  gflags.DEFINE_integer(&#39;num_replicas&#39;, 3, &#39;Number of replicas to start&#39;)</span>
<span class="sd">  gflags.DEFINE_boolean(&#39;rpc2&#39;, True, &#39;Turn on the usage of RPC2.&#39;)</span>

<span class="sd">  ... some code ...</span>

<span class="sd">File libbar.py:</span>

<span class="sd">  import gflags</span>

<span class="sd">  gflags.DEFINE_string(&#39;bar_gfs_path&#39;, &#39;/gfs/path&#39;,</span>
<span class="sd">                      &#39;Path to the GFS files for libbar.&#39;)</span>
<span class="sd">  gflags.DEFINE_string(&#39;email_for_bar_errors&#39;, &#39;bar-team@google.com&#39;,</span>
<span class="sd">                      &#39;Email address for bug reports about module libbar.&#39;)</span>
<span class="sd">  gflags.DEFINE_boolean(&#39;bar_risky_hack&#39;, False,</span>
<span class="sd">                       &#39;Turn on an experimental and buggy optimization.&#39;)</span>

<span class="sd">  ... some code ...</span>

<span class="sd">File myscript.py:</span>

<span class="sd">  import gflags</span>
<span class="sd">  import libfoo</span>
<span class="sd">  import libbar</span>

<span class="sd">  gflags.DEFINE_integer(&#39;num_iterations&#39;, 0, &#39;Number of iterations.&#39;)</span>

<span class="sd">  # Declare that all flags that are key for libfoo are</span>
<span class="sd">  # key for this module too.</span>
<span class="sd">  gflags.ADOPT_module_key_flags(libfoo)</span>

<span class="sd">  # Declare that the flag --bar_gfs_path (defined in libbar) is key</span>
<span class="sd">  # for this module.</span>
<span class="sd">  gflags.DECLARE_key_flag(&#39;bar_gfs_path&#39;)</span>

<span class="sd">  ... some code ...</span>

<span class="sd">When myscript is invoked with the flag --helpshort, the resulted help</span>
<span class="sd">message lists information about all the key flags for myscript:</span>
<span class="sd">--num_iterations, --num_replicas, --rpc2, and --bar_gfs_path.</span>

<span class="sd">Of course, myscript uses all the flags declared by it (in this case,</span>
<span class="sd">just --num_replicas) or by any of the modules it transitively imports</span>
<span class="sd">(e.g., the modules libfoo, libbar).  E.g., it can access the value of</span>
<span class="sd">FLAGS.bar_risky_hack, even if --bar_risky_hack is not declared as a key</span>
<span class="sd">flag for myscript.</span>


<span class="sd">OUTPUT FOR --helpxml:</span>

<span class="sd">The --helpxml flag generates output with the following structure:</span>

<span class="sd">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="sd">&lt;AllFlags&gt;</span>
<span class="sd">  &lt;program&gt;PROGRAM_BASENAME&lt;/program&gt;</span>
<span class="sd">  &lt;usage&gt;MAIN_MODULE_DOCSTRING&lt;/usage&gt;</span>
<span class="sd">  (&lt;flag&gt;</span>
<span class="sd">    [&lt;key&gt;yes&lt;/key&gt;]</span>
<span class="sd">    &lt;file&gt;DECLARING_MODULE&lt;/file&gt;</span>
<span class="sd">    &lt;name&gt;FLAG_NAME&lt;/name&gt;</span>
<span class="sd">    &lt;meaning&gt;FLAG_HELP_MESSAGE&lt;/meaning&gt;</span>
<span class="sd">    &lt;default&gt;DEFAULT_FLAG_VALUE&lt;/default&gt;</span>
<span class="sd">    &lt;current&gt;CURRENT_FLAG_VALUE&lt;/current&gt;</span>
<span class="sd">    &lt;type&gt;FLAG_TYPE&lt;/type&gt;</span>
<span class="sd">    [OPTIONAL_ELEMENTS]</span>
<span class="sd">  &lt;/flag&gt;)*</span>
<span class="sd">&lt;/AllFlags&gt;</span>

<span class="sd">Notes:</span>

<span class="sd">1. The output is intentionally similar to the output generated by the</span>
<span class="sd">C++ command-line flag library.  The few differences are due to the</span>
<span class="sd">Python flags that do not have a C++ equivalent (at least not yet),</span>
<span class="sd">e.g., DEFINE_list.</span>

<span class="sd">2. New XML elements may be added in the future.</span>

<span class="sd">3. DEFAULT_FLAG_VALUE is in serialized form, i.e., the string you can</span>
<span class="sd">pass for this flag on the command-line.  E.g., for a flag defined</span>
<span class="sd">using DEFINE_list, this field may be foo,bar, not [&#39;foo&#39;, &#39;bar&#39;].</span>

<span class="sd">4. CURRENT_FLAG_VALUE is produced using str().  This means that the</span>
<span class="sd">string &#39;false&#39; will be represented in the same way as the boolean</span>
<span class="sd">False.  Using repr() would have removed this ambiguity and simplified</span>
<span class="sd">parsing, but would have broken the compatibility with the C++</span>
<span class="sd">command-line flags.</span>

<span class="sd">5. OPTIONAL_ELEMENTS describe elements relevant for certain kinds of</span>
<span class="sd">flags: lower_bound, upper_bound (for flags that specify bounds),</span>
<span class="sd">enum_value (for enum flags), list_separator (for flags that consist of</span>
<span class="sd">a list of values, separated by a special token).</span>

<span class="sd">6. We do not provide any example here: please use --helpxml instead.</span>

<span class="sd">This module requires at least python 2.2.1 to run.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">cgi</span>
<span class="kn">import</span> <span class="nn">getopt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="c"># pylint: disable-msg=C6204</span>
<span class="k">try</span><span class="p">:</span>
  <span class="kn">import</span> <span class="nn">fcntl</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
  <span class="n">fcntl</span> <span class="o">=</span> <span class="bp">None</span>
<span class="k">try</span><span class="p">:</span>
  <span class="c"># Importing termios will fail on non-unix platforms.</span>
  <span class="kn">import</span> <span class="nn">termios</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
  <span class="n">termios</span> <span class="o">=</span> <span class="bp">None</span>

<span class="kn">import</span> <span class="nn">gflags_validators</span>
<span class="c"># pylint: enable-msg=C6204</span>


<span class="c"># Are we running under pychecker?</span>
<span class="n">_RUNNING_PYCHECKER</span> <span class="o">=</span> <span class="s">&#39;pychecker.python&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span>


<span class="k">def</span> <span class="nf">_GetCallingModuleObjectAndName</span><span class="p">():</span>
  <span class="sd">&quot;&quot;&quot;Returns the module that&#39;s calling into this module.</span>

<span class="sd">  We generally use this function to get the name of the module calling a</span>
<span class="sd">  DEFINE_foo... function.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c"># Walk down the stack to find the first globals dict that&#39;s not ours.</span>
  <span class="k">for</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">getrecursionlimit</span><span class="p">()):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span><span class="o">.</span><span class="n">f_globals</span> <span class="ow">is</span> <span class="nb">globals</span><span class="p">():</span>
      <span class="n">globals_for_frame</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">(</span><span class="n">depth</span><span class="p">)</span><span class="o">.</span><span class="n">f_globals</span>
      <span class="n">module</span><span class="p">,</span> <span class="n">module_name</span> <span class="o">=</span> <span class="n">_GetModuleObjectAndName</span><span class="p">(</span><span class="n">globals_for_frame</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">module_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">module</span><span class="p">,</span> <span class="n">module_name</span>
  <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="s">&quot;No module was found&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_GetCallingModule</span><span class="p">():</span>
  <span class="sd">&quot;&quot;&quot;Returns the name of the module that&#39;s calling into this module.&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">_GetCallingModuleObjectAndName</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">_GetThisModuleObjectAndName</span><span class="p">():</span>
  <span class="sd">&quot;&quot;&quot;Returns: (module object, module name) for this module.&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">_GetModuleObjectAndName</span><span class="p">(</span><span class="nb">globals</span><span class="p">())</span>


<span class="c"># module exceptions:</span>
<div class="viewcode-block" id="FlagsError"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagsError">[docs]</a><span class="k">class</span> <span class="nc">FlagsError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;The base class for all flags errors.&quot;&quot;&quot;</span>
  <span class="k">pass</span>

</div>
<div class="viewcode-block" id="DuplicateFlag"><a class="viewcode-back" href="../../lib.html#lib.gflags.DuplicateFlag">[docs]</a><span class="k">class</span> <span class="nc">DuplicateFlag</span><span class="p">(</span><span class="n">FlagsError</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Raised if there is a flag naming conflict.&quot;&quot;&quot;</span>
  <span class="k">pass</span>
</div>
<div class="viewcode-block" id="CantOpenFlagFileError"><a class="viewcode-back" href="../../lib.html#lib.gflags.CantOpenFlagFileError">[docs]</a><span class="k">class</span> <span class="nc">CantOpenFlagFileError</span><span class="p">(</span><span class="n">FlagsError</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Raised if flagfile fails to open: doesn&#39;t exist, wrong permissions, etc.&quot;&quot;&quot;</span>
  <span class="k">pass</span>

</div>
<div class="viewcode-block" id="DuplicateFlagCannotPropagateNoneToSwig"><a class="viewcode-back" href="../../lib.html#lib.gflags.DuplicateFlagCannotPropagateNoneToSwig">[docs]</a><span class="k">class</span> <span class="nc">DuplicateFlagCannotPropagateNoneToSwig</span><span class="p">(</span><span class="n">DuplicateFlag</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Special case of DuplicateFlag -- SWIG flag value can&#39;t be set to None.</span>

<span class="sd">  This can be raised when a duplicate flag is created. Even if allow_override is</span>
<span class="sd">  True, we still abort if the new value is None, because it&#39;s currently</span>
<span class="sd">  impossible to pass None default value back to SWIG. See FlagValues.SetDefault</span>
<span class="sd">  for details.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">pass</span>

</div>
<div class="viewcode-block" id="DuplicateFlagError"><a class="viewcode-back" href="../../lib.html#lib.gflags.DuplicateFlagError">[docs]</a><span class="k">class</span> <span class="nc">DuplicateFlagError</span><span class="p">(</span><span class="n">DuplicateFlag</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A DuplicateFlag whose message cites the conflicting definitions.</span>

<span class="sd">  A DuplicateFlagError conveys more information than a DuplicateFlag,</span>
<span class="sd">  namely the modules where the conflicting definitions occur. This</span>
<span class="sd">  class was created to avoid breaking external modules which depend on</span>
<span class="sd">  the existing DuplicateFlags interface.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flagname</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">,</span> <span class="n">other_flag_values</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a DuplicateFlagError.</span>

<span class="sd">    Args:</span>
<span class="sd">      flagname: Name of the flag being redefined.</span>
<span class="sd">      flag_values: FlagValues object containing the first definition of</span>
<span class="sd">          flagname.</span>
<span class="sd">      other_flag_values: If this argument is not None, it should be the</span>
<span class="sd">          FlagValues object where the second definition of flagname occurs.</span>
<span class="sd">          If it is None, we assume that we&#39;re being called when attempting</span>
<span class="sd">          to create the flag a second time, and we use the module calling</span>
<span class="sd">          this one as the source of the second definition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flagname</span> <span class="o">=</span> <span class="n">flagname</span>
    <span class="n">first_module</span> <span class="o">=</span> <span class="n">flag_values</span><span class="o">.</span><span class="n">FindModuleDefiningFlag</span><span class="p">(</span>
        <span class="n">flagname</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;&lt;unknown&gt;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">other_flag_values</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">second_module</span> <span class="o">=</span> <span class="n">_GetCallingModule</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">second_module</span> <span class="o">=</span> <span class="n">other_flag_values</span><span class="o">.</span><span class="n">FindModuleDefiningFlag</span><span class="p">(</span>
          <span class="n">flagname</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;&lt;unknown&gt;&#39;</span><span class="p">)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s">&quot;The flag &#39;</span><span class="si">%s</span><span class="s">&#39; is defined twice. First from </span><span class="si">%s</span><span class="s">, Second from </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flagname</span><span class="p">,</span> <span class="n">first_module</span><span class="p">,</span> <span class="n">second_module</span><span class="p">)</span>
    <span class="n">DuplicateFlag</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="IllegalFlagValue"><a class="viewcode-back" href="../../lib.html#lib.gflags.IllegalFlagValue">[docs]</a><span class="k">class</span> <span class="nc">IllegalFlagValue</span><span class="p">(</span><span class="n">FlagsError</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;The flag command line argument is illegal.&quot;&quot;&quot;</span>
  <span class="k">pass</span>

</div>
<div class="viewcode-block" id="UnrecognizedFlag"><a class="viewcode-back" href="../../lib.html#lib.gflags.UnrecognizedFlag">[docs]</a><span class="k">class</span> <span class="nc">UnrecognizedFlag</span><span class="p">(</span><span class="n">FlagsError</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Raised if a flag is unrecognized.&quot;&quot;&quot;</span>
  <span class="k">pass</span>


<span class="c"># An UnrecognizedFlagError conveys more information than an UnrecognizedFlag.</span>
<span class="c"># Since there are external modules that create DuplicateFlags, the interface to</span>
<span class="c"># DuplicateFlag shouldn&#39;t change.  The flagvalue will be assigned the full value</span>
<span class="c"># of the flag and its argument, if any, allowing handling of unrecognized flags</span>
<span class="c"># in an exception handler.</span>
<span class="c"># If flagvalue is the empty string, then this exception is an due to a</span>
<span class="c"># reference to a flag that was not already defined.</span></div>
<div class="viewcode-block" id="UnrecognizedFlagError"><a class="viewcode-back" href="../../lib.html#lib.gflags.UnrecognizedFlagError">[docs]</a><span class="k">class</span> <span class="nc">UnrecognizedFlagError</span><span class="p">(</span><span class="n">UnrecognizedFlag</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flagname</span><span class="p">,</span> <span class="n">flagvalue</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flagname</span> <span class="o">=</span> <span class="n">flagname</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flagvalue</span> <span class="o">=</span> <span class="n">flagvalue</span>
    <span class="n">UnrecognizedFlag</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="s">&quot;Unknown command line flag &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="n">flagname</span><span class="p">)</span>

<span class="c"># Global variable used by expvar</span></div>
<span class="n">_exported_flags</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">_help_width</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c"># width of help output</span>


<div class="viewcode-block" id="GetHelpWidth"><a class="viewcode-back" href="../../lib.html#lib.gflags.GetHelpWidth">[docs]</a><span class="k">def</span> <span class="nf">GetHelpWidth</span><span class="p">():</span>
  <span class="sd">&quot;&quot;&quot;Returns: an integer, the width of help lines that is used in TextWrap.&quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">isatty</span><span class="p">())</span> <span class="ow">or</span> <span class="p">(</span><span class="n">termios</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">fcntl</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_help_width</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">fcntl</span><span class="o">.</span><span class="n">ioctl</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">termios</span><span class="o">.</span><span class="n">TIOCGWINSZ</span><span class="p">,</span> <span class="s">&#39;1234&#39;</span><span class="p">)</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;hh&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c"># Emacs mode returns 0.</span>
    <span class="c"># Here we assume that any value below 40 is unreasonable</span>
    <span class="k">if</span> <span class="n">columns</span> <span class="o">&gt;=</span> <span class="mi">40</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">columns</span>
    <span class="c"># Returning an int as default is fine, int(int) just return the int.</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">&#39;COLUMNS&#39;</span><span class="p">,</span> <span class="n">_help_width</span><span class="p">))</span>

  <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IOError</span><span class="p">,</span> <span class="n">struct</span><span class="o">.</span><span class="n">error</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_help_width</span>

</div>
<div class="viewcode-block" id="CutCommonSpacePrefix"><a class="viewcode-back" href="../../lib.html#lib.gflags.CutCommonSpacePrefix">[docs]</a><span class="k">def</span> <span class="nf">CutCommonSpacePrefix</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Removes a common space prefix from the lines of a multiline text.</span>

<span class="sd">  If the first line does not start with a space, it is left as it is and</span>
<span class="sd">  only in the remaining lines a common space prefix is being searched</span>
<span class="sd">  for. That means the first line will stay untouched. This is especially</span>
<span class="sd">  useful to turn doc strings into help texts. This is because some</span>
<span class="sd">  people prefer to have the doc comment start already after the</span>
<span class="sd">  apostrophe and then align the following lines while others have the</span>
<span class="sd">  apostrophes on a separate line.</span>

<span class="sd">  The function also drops trailing empty lines and ignores empty lines</span>
<span class="sd">  following the initial content line while calculating the initial</span>
<span class="sd">  common whitespace.</span>

<span class="sd">  Args:</span>
<span class="sd">    text: text to work on</span>

<span class="sd">  Returns:</span>
<span class="sd">    the resulting text</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">text_lines</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
  <span class="c"># Drop trailing empty lines</span>
  <span class="k">while</span> <span class="n">text_lines</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">text_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    <span class="n">text_lines</span> <span class="o">=</span> <span class="n">text_lines</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="k">if</span> <span class="n">text_lines</span><span class="p">:</span>
    <span class="c"># We got some content, is the first line starting with a space?</span>
    <span class="k">if</span> <span class="n">text_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">text_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
      <span class="n">text_first_line</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">text_first_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">text_lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
    <span class="c"># Calculate length of common leading whitespace (only over content lines)</span>
    <span class="n">common_prefix</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">commonprefix</span><span class="p">([</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">text_lines</span> <span class="k">if</span> <span class="n">line</span><span class="p">])</span>
    <span class="n">space_prefix_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_prefix</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_prefix</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())</span>
    <span class="c"># If we have a common space prefix, drop it from all lines</span>
    <span class="k">if</span> <span class="n">space_prefix_len</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text_lines</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">text_lines</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
          <span class="n">text_lines</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_lines</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">space_prefix_len</span><span class="p">:]</span>
    <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text_first_line</span> <span class="o">+</span> <span class="n">text_lines</span><span class="p">)</span>
  <span class="k">return</span> <span class="s">&#39;&#39;</span>

</div>
<div class="viewcode-block" id="TextWrap"><a class="viewcode-back" href="../../lib.html#lib.gflags.TextWrap">[docs]</a><span class="k">def</span> <span class="nf">TextWrap</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">firstline_indent</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tabs</span><span class="o">=</span><span class="s">&#39;    &#39;</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Wraps a given text to a maximum line length and returns it.</span>

<span class="sd">  We turn lines that only contain whitespace into empty lines.  We keep</span>
<span class="sd">  new lines and tabs (e.g., we do not treat tabs as spaces).</span>

<span class="sd">  Args:</span>
<span class="sd">    text:             text to wrap</span>
<span class="sd">    length:           maximum length of a line, includes indentation</span>
<span class="sd">                      if this is None then use GetHelpWidth()</span>
<span class="sd">    indent:           indent for all but first line</span>
<span class="sd">    firstline_indent: indent for first line; if None, fall back to indent</span>
<span class="sd">    tabs:             replacement for tabs</span>

<span class="sd">  Returns:</span>
<span class="sd">    wrapped text</span>

<span class="sd">  Raises:</span>
<span class="sd">    FlagsError: if indent not shorter than length</span>
<span class="sd">    FlagsError: if firstline_indent not shorter than length</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c"># Get defaults where callee used None</span>
  <span class="k">if</span> <span class="n">length</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">GetHelpWidth</span><span class="p">()</span>
  <span class="k">if</span> <span class="n">indent</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">indent</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="p">:</span>
    <span class="k">raise</span> <span class="n">FlagsError</span><span class="p">(</span><span class="s">&#39;Indent must be shorter than length&#39;</span><span class="p">)</span>
  <span class="c"># In line we will be holding the current line which is to be started</span>
  <span class="c"># with indent (or firstline_indent if available) and then appended</span>
  <span class="c"># with words.</span>
  <span class="k">if</span> <span class="n">firstline_indent</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">firstline_indent</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">indent</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">firstline_indent</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">firstline_indent</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">FlagsError</span><span class="p">(</span><span class="s">&#39;First line indent must be shorter than length&#39;</span><span class="p">)</span>

  <span class="c"># If the callee does not care about tabs we simply convert them to</span>
  <span class="c"># spaces If callee wanted tabs to be single space then we do that</span>
  <span class="c"># already here.</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">tabs</span> <span class="ow">or</span> <span class="n">tabs</span> <span class="o">==</span> <span class="s">&#39; &#39;</span><span class="p">:</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\t</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">tabs_are_whitespace</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">tabs</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

  <span class="n">line_regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;([ ]*)(</span><span class="se">\t</span><span class="s">*)([^ </span><span class="se">\t</span><span class="s">]+)&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>

  <span class="c"># Split the text into lines and the lines with the regex above. The</span>
  <span class="c"># resulting lines are collected in result[]. For each split we get the</span>
  <span class="c"># spaces, the tabs and the next non white space (e.g. next word).</span>
  <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">text_line</span> <span class="ow">in</span> <span class="n">text</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
    <span class="c"># Store result length so we can find out whether processing the next</span>
    <span class="c"># line gave any new content</span>
    <span class="n">old_result_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
    <span class="c"># Process next line with line_regex. For optimization we do an rstrip().</span>
    <span class="c"># - process tabs (changes either line or word, see below)</span>
    <span class="c"># - process word (first try to squeeze on line, then wrap or force wrap)</span>
    <span class="c"># Spaces found on the line are ignored, they get added while wrapping as</span>
    <span class="c"># needed.</span>
    <span class="k">for</span> <span class="n">spaces</span><span class="p">,</span> <span class="n">current_tabs</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">line_regex</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">text_line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()):</span>
      <span class="c"># If tabs weren&#39;t converted to spaces, handle them now</span>
      <span class="k">if</span> <span class="n">current_tabs</span><span class="p">:</span>
        <span class="c"># If the last thing we added was a space anyway then drop</span>
        <span class="c"># it. But let&#39;s not get rid of the indentation.</span>
        <span class="k">if</span> <span class="p">(((</span><span class="n">result</span> <span class="ow">and</span> <span class="n">line</span> <span class="o">!=</span> <span class="n">indent</span><span class="p">)</span> <span class="ow">or</span>
             <span class="p">(</span><span class="ow">not</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">line</span> <span class="o">!=</span> <span class="n">firstline_indent</span><span class="p">))</span> <span class="ow">and</span> <span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39; &#39;</span><span class="p">):</span>
          <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c"># Add the tabs, if that means adding whitespace, just add it at</span>
        <span class="c"># the line, the rstrip() code while shorten the line down if</span>
        <span class="c"># necessary</span>
        <span class="k">if</span> <span class="n">tabs_are_whitespace</span><span class="p">:</span>
          <span class="n">line</span> <span class="o">+=</span> <span class="n">tabs</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_tabs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="c"># if not all tab replacement is whitespace we prepend it to the word</span>
          <span class="n">word</span> <span class="o">=</span> <span class="n">tabs</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">current_tabs</span><span class="p">)</span> <span class="o">+</span> <span class="n">word</span>
      <span class="c"># Handle the case where word cannot be squeezed onto current last line</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">length</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">indent</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">length</span><span class="p">:</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="n">word</span>
        <span class="n">word</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="c"># No space left on line or can we append a space?</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="p">:</span>
          <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
          <span class="n">line</span> <span class="o">=</span> <span class="n">indent</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">line</span> <span class="o">+=</span> <span class="s">&#39; &#39;</span>
      <span class="c"># Add word and shorten it up to allowed line length. Restart next</span>
      <span class="c"># line with indent and repeat, or add a space if we&#39;re done (word</span>
      <span class="c"># finished) This deals with words that cannot fit on one line</span>
      <span class="c"># (e.g. indent + word longer than allowed line length).</span>
      <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">+=</span> <span class="n">word</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[:</span><span class="n">length</span><span class="p">])</span>
        <span class="n">word</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">length</span><span class="p">:]</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">indent</span>
      <span class="c"># Default case, simply append the word and a space</span>
      <span class="k">if</span> <span class="n">word</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">+=</span> <span class="n">word</span> <span class="o">+</span> <span class="s">&#39; &#39;</span>
    <span class="c"># End of input line. If we have content we finish the line. If the</span>
    <span class="c"># current line is just the indent but we had content in during this</span>
    <span class="c"># original line then we need to add an empty line.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="ow">and</span> <span class="n">line</span> <span class="o">!=</span> <span class="n">indent</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="n">result</span> <span class="ow">and</span> <span class="n">line</span> <span class="o">!=</span> <span class="n">firstline_indent</span><span class="p">):</span>
      <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">==</span> <span class="n">old_result_len</span><span class="p">:</span>
      <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">indent</span>

  <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="DocToHelp"><a class="viewcode-back" href="../../lib.html#lib.gflags.DocToHelp">[docs]</a><span class="k">def</span> <span class="nf">DocToHelp</span><span class="p">(</span><span class="n">doc</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Takes a __doc__ string and reformats it as help.&quot;&quot;&quot;</span>

  <span class="c"># Get rid of starting and ending white space. Using lstrip() or even</span>
  <span class="c"># strip() could drop more than maximum of first line and right space</span>
  <span class="c"># of last line.</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

  <span class="c"># Get rid of all empty lines</span>
  <span class="n">whitespace_only_line</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&#39;^[ </span><span class="se">\t</span><span class="s">]+$&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">whitespace_only_line</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">doc</span><span class="p">)</span>

  <span class="c"># Cut out common space at line beginnings</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">CutCommonSpacePrefix</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

  <span class="c"># Just like this module&#39;s comment, comments tend to be aligned somehow.</span>
  <span class="c"># In other words they all start with the same amount of white space</span>
  <span class="c"># 1) keep double new lines</span>
  <span class="c"># 2) keep ws after new lines if not empty line</span>
  <span class="c"># 3) all other new lines shall be changed to a space</span>
  <span class="c"># Solution: Match new lines between non white space and replace with space.</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&#39;(?&lt;=\S)</span><span class="se">\n</span><span class="s">(?=\S)&#39;</span><span class="p">,</span> <span class="s">&#39; &#39;</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">doc</span>

</div>
<span class="k">def</span> <span class="nf">_GetModuleObjectAndName</span><span class="p">(</span><span class="n">globals_dict</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Returns the module that defines a global environment, and its name.</span>

<span class="sd">  Args:</span>
<span class="sd">    globals_dict: A dictionary that should correspond to an environment</span>
<span class="sd">      providing the values of the globals.</span>

<span class="sd">  Returns:</span>
<span class="sd">    A pair consisting of (1) module object and (2) module name (a</span>
<span class="sd">    string).  Returns (None, None) if the module could not be</span>
<span class="sd">    identified.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c"># The use of .items() (instead of .iteritems()) is NOT a mistake: if</span>
  <span class="c"># a parallel thread imports a module while we iterate over</span>
  <span class="c"># .iteritems() (not nice, but possible), we get a RuntimeError ...</span>
  <span class="c"># Hence, we use the slightly slower but safer .items().</span>
  <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="s">&#39;__dict__&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="ow">is</span> <span class="n">globals_dict</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
        <span class="c"># Pick a more informative name for the main module.</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
  <span class="k">return</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_GetMainModule</span><span class="p">():</span>
  <span class="sd">&quot;&quot;&quot;Returns: string, name of the module from which execution started.&quot;&quot;&quot;</span>
  <span class="c"># First, try to use the same logic used by _GetCallingModuleObjectAndName(),</span>
  <span class="c"># i.e., call _GetModuleObjectAndName().  For that we first need to</span>
  <span class="c"># find the dictionary that the main module uses to store the</span>
  <span class="c"># globals.</span>
  <span class="c">#</span>
  <span class="c"># That&#39;s (normally) the same dictionary object that the deepest</span>
  <span class="c"># (oldest) stack frame is using for globals.</span>
  <span class="n">deepest_frame</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="k">while</span> <span class="n">deepest_frame</span><span class="o">.</span><span class="n">f_back</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">deepest_frame</span> <span class="o">=</span> <span class="n">deepest_frame</span><span class="o">.</span><span class="n">f_back</span>
  <span class="n">globals_for_main_module</span> <span class="o">=</span> <span class="n">deepest_frame</span><span class="o">.</span><span class="n">f_globals</span>
  <span class="n">main_module_name</span> <span class="o">=</span> <span class="n">_GetModuleObjectAndName</span><span class="p">(</span><span class="n">globals_for_main_module</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
  <span class="c"># The above strategy fails in some cases (e.g., tools that compute</span>
  <span class="c"># code coverage by redefining, among other things, the main module).</span>
  <span class="c"># If so, just use sys.argv[0].  We can probably always do this, but</span>
  <span class="c"># it&#39;s safest to try to use the same logic as _GetCallingModuleObjectAndName()</span>
  <span class="k">if</span> <span class="n">main_module_name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">main_module_name</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="k">return</span> <span class="n">main_module_name</span>


<div class="viewcode-block" id="FlagValues"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues">[docs]</a><span class="k">class</span> <span class="nc">FlagValues</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;Registry of &#39;Flag&#39; objects.</span>

<span class="sd">  A &#39;FlagValues&#39; can then scan command line arguments, passing flag</span>
<span class="sd">  arguments through to the &#39;Flag&#39; objects that it owns.  It also</span>
<span class="sd">  provides easy access to the flag values.  Typically only one</span>
<span class="sd">  &#39;FlagValues&#39; object is needed by an application: gflags.FLAGS</span>

<span class="sd">  This class is heavily overloaded:</span>

<span class="sd">  &#39;Flag&#39; objects are registered via __setitem__:</span>
<span class="sd">       FLAGS[&#39;longname&#39;] = x   # register a new flag</span>

<span class="sd">  The .value attribute of the registered &#39;Flag&#39; objects can be accessed</span>
<span class="sd">  as attributes of this &#39;FlagValues&#39; object, through __getattr__.  Both</span>
<span class="sd">  the long and short name of the original &#39;Flag&#39; objects can be used to</span>
<span class="sd">  access its value:</span>
<span class="sd">       FLAGS.longname          # parsed flag value</span>
<span class="sd">       FLAGS.x                 # parsed flag value (short name)</span>

<span class="sd">  Command line arguments are scanned and passed to the registered &#39;Flag&#39;</span>
<span class="sd">  objects through the __call__ method.  Unparsed arguments, including</span>
<span class="sd">  argv[0] (e.g. the program name) are returned.</span>
<span class="sd">       argv = FLAGS(sys.argv)  # scan command line arguments</span>

<span class="sd">  The original registered Flag objects can be retrieved through the use</span>
<span class="sd">  of the dictionary-like operator, __getitem__:</span>
<span class="sd">       x = FLAGS[&#39;longname&#39;]   # access the registered Flag object</span>

<span class="sd">  The str() operator of a &#39;FlagValues&#39; object provides help for all of</span>
<span class="sd">  the registered &#39;Flag&#39; objects.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c"># Since everything in this class is so heavily overloaded, the only</span>
    <span class="c"># way of defining and using fields is to access __dict__ directly.</span>

    <span class="c"># Dictionary: flag name (string) -&gt; Flag object.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__flags&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c"># Dictionary: module name (string) -&gt; list of Flag objects that are defined</span>
    <span class="c"># by that module.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__flags_by_module&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c"># Dictionary: module id (int) -&gt; list of Flag objects that are defined by</span>
    <span class="c"># that module.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__flags_by_module_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c"># Dictionary: module name (string) -&gt; list of Flag objects that are</span>
    <span class="c"># key for that module.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__key_flags_by_module&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c"># Set if we should use new style gnu_getopt rather than getopt when parsing</span>
    <span class="c"># the args.  Only possible with Python 2.3+</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">UseGnuGetOpt</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<div class="viewcode-block" id="FlagValues.UseGnuGetOpt"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.UseGnuGetOpt">[docs]</a>  <span class="k">def</span> <span class="nf">UseGnuGetOpt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_gnu_getopt</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Use GNU-style scanning. Allows mixing of flag and non-flag arguments.</span>

<span class="sd">    See http://docs.python.org/library/getopt.html#getopt.gnu_getopt</span>

<span class="sd">    Args:</span>
<span class="sd">      use_gnu_getopt: wether or not to use GNU style scanning.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__use_gnu_getopt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">use_gnu_getopt</span>
</div>
<div class="viewcode-block" id="FlagValues.IsGnuGetOpt"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.IsGnuGetOpt">[docs]</a>  <span class="k">def</span> <span class="nf">IsGnuGetOpt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__use_gnu_getopt&#39;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="FlagValues.FlagDict"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.FlagDict">[docs]</a>  <span class="k">def</span> <span class="nf">FlagDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__flags&#39;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="FlagValues.FlagsByModuleDict"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.FlagsByModuleDict">[docs]</a>  <span class="k">def</span> <span class="nf">FlagsByModuleDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the dictionary of module_name -&gt; list of defined flags.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A dictionary.  Its keys are module names (strings).  Its values</span>
<span class="sd">      are lists of Flag objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__flags_by_module&#39;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="FlagValues.FlagsByModuleIdDict"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.FlagsByModuleIdDict">[docs]</a>  <span class="k">def</span> <span class="nf">FlagsByModuleIdDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the dictionary of module_id -&gt; list of defined flags.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A dictionary.  Its keys are module IDs (ints).  Its values</span>
<span class="sd">      are lists of Flag objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__flags_by_module_id&#39;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="FlagValues.KeyFlagsByModuleDict"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.KeyFlagsByModuleDict">[docs]</a>  <span class="k">def</span> <span class="nf">KeyFlagsByModuleDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the dictionary of module_name -&gt; list of key flags.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A dictionary.  Its keys are module names (strings).  Its values</span>
<span class="sd">      are lists of Flag objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__key_flags_by_module&#39;</span><span class="p">]</span>
</div>
  <span class="k">def</span> <span class="nf">_RegisterFlagByModule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Records the module that defines a specific flag.</span>

<span class="sd">    We keep track of which flag is defined by which module so that we</span>
<span class="sd">    can later sort the flags by module.</span>

<span class="sd">    Args:</span>
<span class="sd">      module_name: A string, the name of a Python module.</span>
<span class="sd">      flag: A Flag object, a flag that is key to the module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flags_by_module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagsByModuleDict</span><span class="p">()</span>
    <span class="n">flags_by_module</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_RegisterFlagByModuleId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_id</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Records the module that defines a specific flag.</span>

<span class="sd">    Args:</span>
<span class="sd">      module_id: An int, the ID of the Python module.</span>
<span class="sd">      flag: A Flag object, a flag that is key to the module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flags_by_module_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagsByModuleIdDict</span><span class="p">()</span>
    <span class="n">flags_by_module_id</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">module_id</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_RegisterKeyFlagForModule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Specifies that a flag is a key flag for a module.</span>

<span class="sd">    Args:</span>
<span class="sd">      module_name: A string, the name of a Python module.</span>
<span class="sd">      flag: A Flag object, a flag that is key to the module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key_flags_by_module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">KeyFlagsByModuleDict</span><span class="p">()</span>
    <span class="c"># The list of key flags for the module named module_name.</span>
    <span class="n">key_flags</span> <span class="o">=</span> <span class="n">key_flags_by_module</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="p">[])</span>
    <span class="c"># Add flag, but avoid duplicates.</span>
    <span class="k">if</span> <span class="n">flag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key_flags</span><span class="p">:</span>
      <span class="n">key_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_GetFlagsDefinedByModule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the list of flags defined by a module.</span>

<span class="sd">    Args:</span>
<span class="sd">      module: A module object or a module name (a string).</span>

<span class="sd">    Returns:</span>
<span class="sd">      A new list of Flag objects.  Caller may update this list as he</span>
<span class="sd">      wishes: none of those changes will affect the internals of this</span>
<span class="sd">      FlagValue object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
      <span class="n">module</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">__name__</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlagsByModuleDict</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="p">[]))</span>

  <span class="k">def</span> <span class="nf">_GetKeyFlagsForModule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the list of key flags for a module.</span>

<span class="sd">    Args:</span>
<span class="sd">      module: A module object or a module name (a string)</span>

<span class="sd">    Returns:</span>
<span class="sd">      A new list of Flag objects.  Caller may update this list as he</span>
<span class="sd">      wishes: none of those changes will affect the internals of this</span>
<span class="sd">      FlagValue object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
      <span class="n">module</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">__name__</span>

    <span class="c"># Any flag is a key flag for the module that defined it.  NOTE:</span>
    <span class="c"># key_flags is a fresh list: we can update it without affecting the</span>
    <span class="c"># internals of this FlagValues object.</span>
    <span class="n">key_flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetFlagsDefinedByModule</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>

    <span class="c"># Take into account flags explicitly declared as key for a module.</span>
    <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">KeyFlagsByModuleDict</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="p">[]):</span>
      <span class="k">if</span> <span class="n">flag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">key_flags</span><span class="p">:</span>
        <span class="n">key_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">key_flags</span>

<div class="viewcode-block" id="FlagValues.FindModuleDefiningFlag"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.FindModuleDefiningFlag">[docs]</a>  <span class="k">def</span> <span class="nf">FindModuleDefiningFlag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flagname</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the name of the module defining this flag, or default.</span>

<span class="sd">    Args:</span>
<span class="sd">      flagname: Name of the flag to lookup.</span>
<span class="sd">      default: Value to return if flagname is not defined. Defaults</span>
<span class="sd">          to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The name of the module which registered the flag with this name.</span>
<span class="sd">      If no such module exists (i.e. no flag with this name exists),</span>
<span class="sd">      we return default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">module</span><span class="p">,</span> <span class="n">flags</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagsByModuleDict</span><span class="p">()</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
      <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">flagname</span> <span class="ow">or</span> <span class="n">flag</span><span class="o">.</span><span class="n">short_name</span> <span class="o">==</span> <span class="n">flagname</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">module</span>
    <span class="k">return</span> <span class="n">default</span>
</div>
<div class="viewcode-block" id="FlagValues.FindModuleIdDefiningFlag"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.FindModuleIdDefiningFlag">[docs]</a>  <span class="k">def</span> <span class="nf">FindModuleIdDefiningFlag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flagname</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the ID of the module defining this flag, or default.</span>

<span class="sd">    Args:</span>
<span class="sd">      flagname: Name of the flag to lookup.</span>
<span class="sd">      default: Value to return if flagname is not defined. Defaults</span>
<span class="sd">          to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The ID of the module which registered the flag with this name.</span>
<span class="sd">      If no such module exists (i.e. no flag with this name exists),</span>
<span class="sd">      we return default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">module_id</span><span class="p">,</span> <span class="n">flags</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagsByModuleIdDict</span><span class="p">()</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
      <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flags</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">flagname</span> <span class="ow">or</span> <span class="n">flag</span><span class="o">.</span><span class="n">short_name</span> <span class="o">==</span> <span class="n">flagname</span><span class="p">:</span>
          <span class="k">return</span> <span class="n">module_id</span>
    <span class="k">return</span> <span class="n">default</span>
</div>
<div class="viewcode-block" id="FlagValues.AppendFlagValues"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.AppendFlagValues">[docs]</a>  <span class="k">def</span> <span class="nf">AppendFlagValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Appends flags registered in another FlagValues instance.</span>

<span class="sd">    Args:</span>
<span class="sd">      flag_values: registry to copy from</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">flag_name</span><span class="p">,</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flag_values</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
      <span class="c"># Each flags with shortname appears here twice (once under its</span>
      <span class="c"># normal name, and again with its short name).  To prevent</span>
      <span class="c"># problems (DuplicateFlagError) with double flag registration, we</span>
      <span class="c"># perform a check to make sure that the entry we&#39;re looking at is</span>
      <span class="c"># for its normal name.</span>
      <span class="k">if</span> <span class="n">flag_name</span> <span class="o">==</span> <span class="n">flag</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
          <span class="bp">self</span><span class="p">[</span><span class="n">flag_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
        <span class="k">except</span> <span class="n">DuplicateFlagError</span><span class="p">:</span>
          <span class="k">raise</span> <span class="n">DuplicateFlagError</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span>
                                   <span class="n">other_flag_values</span><span class="o">=</span><span class="n">flag_values</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FlagValues.RemoveFlagValues"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.RemoveFlagValues">[docs]</a>  <span class="k">def</span> <span class="nf">RemoveFlagValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove flags that were previously appended from another FlagValues.</span>

<span class="sd">    Args:</span>
<span class="sd">      flag_values: registry containing flags to remove.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">flag_name</span> <span class="ow">in</span> <span class="n">flag_values</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__delattr__</span><span class="p">(</span><span class="n">flag_name</span><span class="p">)</span>
</div>
  <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Registers a new flag variable.&quot;&quot;&quot;</span>
    <span class="n">fl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">Flag</span><span class="p">):</span>
      <span class="k">raise</span> <span class="n">IllegalFlagValue</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)):</span>
      <span class="k">raise</span> <span class="n">FlagsError</span><span class="p">(</span><span class="s">&quot;Flag name must be a string&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">FlagsError</span><span class="p">(</span><span class="s">&quot;Flag name cannot be empty&quot;</span><span class="p">)</span>
    <span class="c"># If running under pychecker, duplicate keys are likely to be</span>
    <span class="c"># defined.  Disable check for duplicate keys when pycheck&#39;ing.</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">in</span> <span class="n">fl</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">flag</span><span class="o">.</span><span class="n">allow_override</span> <span class="ow">and</span>
        <span class="ow">not</span> <span class="n">fl</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">allow_override</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_RUNNING_PYCHECKER</span><span class="p">):</span>
      <span class="n">module</span><span class="p">,</span> <span class="n">module_name</span> <span class="o">=</span> <span class="n">_GetCallingModuleObjectAndName</span><span class="p">()</span>
      <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FindModuleDefiningFlag</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="n">module_name</span> <span class="ow">and</span>
          <span class="nb">id</span><span class="p">(</span><span class="n">module</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FindModuleIdDefiningFlag</span><span class="p">(</span><span class="n">name</span><span class="p">)):</span>
        <span class="c"># If the flag has already been defined by a module with the same name,</span>
        <span class="c"># but a different ID, we can stop here because it indicates that the</span>
        <span class="c"># module is simply being imported a subsequent time.</span>
        <span class="k">return</span>
      <span class="k">raise</span> <span class="n">DuplicateFlagError</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
    <span class="n">short_name</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="n">short_name</span>
    <span class="k">if</span> <span class="n">short_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">short_name</span> <span class="ow">in</span> <span class="n">fl</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">flag</span><span class="o">.</span><span class="n">allow_override</span> <span class="ow">and</span>
          <span class="ow">not</span> <span class="n">fl</span><span class="p">[</span><span class="n">short_name</span><span class="p">]</span><span class="o">.</span><span class="n">allow_override</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">_RUNNING_PYCHECKER</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">DuplicateFlagError</span><span class="p">(</span><span class="n">short_name</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
      <span class="n">fl</span><span class="p">[</span><span class="n">short_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
    <span class="n">fl</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
    <span class="k">global</span> <span class="n">_exported_flags</span>
    <span class="n">_exported_flags</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>

  <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Retrieves the Flag object for the flag --name.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()[</span><span class="n">name</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Retrieves the &#39;value&#39; attribute of the flag --name.&quot;&quot;&quot;</span>
    <span class="n">fl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fl</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>

  <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sets the &#39;value&#39; attribute of the flag --name.&quot;&quot;&quot;</span>
    <span class="n">fl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span>
    <span class="n">fl</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_AssertValidators</span><span class="p">(</span><span class="n">fl</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">validators</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>

  <span class="k">def</span> <span class="nf">_AssertAllValidators</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">all_validators</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span><span class="o">.</span><span class="n">itervalues</span><span class="p">():</span>
      <span class="k">for</span> <span class="n">validator</span> <span class="ow">in</span> <span class="n">flag</span><span class="o">.</span><span class="n">validators</span><span class="p">:</span>
        <span class="n">all_validators</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">validator</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_AssertValidators</span><span class="p">(</span><span class="n">all_validators</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_AssertValidators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validators</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Assert if all validators in the list are satisfied.</span>

<span class="sd">    Asserts validators in the order they were created.</span>
<span class="sd">    Args:</span>
<span class="sd">      validators: Iterable(gflags_validators.Validator), validators to be</span>
<span class="sd">        verified</span>
<span class="sd">    Raises:</span>
<span class="sd">      AttributeError: if validators work with a non-existing flag.</span>
<span class="sd">      IllegalFlagValue: if validation fails for at least one validator</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">validator</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span>
        <span class="n">validators</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">validator</span><span class="p">:</span> <span class="n">validator</span><span class="o">.</span><span class="n">insertion_index</span><span class="p">):</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">validator</span><span class="o">.</span><span class="n">Verify</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
      <span class="k">except</span> <span class="n">gflags_validators</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">validator</span><span class="o">.</span><span class="n">PrintFlagsWithValues</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">IllegalFlagValue</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>

  <span class="k">def</span> <span class="nf">_FlagIsRegistered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag_obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks whether a Flag object is registered under some name.</span>

<span class="sd">    Note: this is non trivial: in addition to its normal name, a flag</span>
<span class="sd">    may have a short name too.  In self.FlagDict(), both the normal and</span>
<span class="sd">    the short name are mapped to the same flag object.  E.g., calling</span>
<span class="sd">    only &quot;del FLAGS.short_name&quot; is not unregistering the corresponding</span>
<span class="sd">    Flag object (it is still registered under the longer name).</span>

<span class="sd">    Args:</span>
<span class="sd">      flag_obj: A Flag object.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A boolean: True iff flag_obj is registered under some name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flag_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span>
    <span class="c"># Check whether flag_obj is registered under its long name.</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">flag_obj</span><span class="o">.</span><span class="n">name</span>
    <span class="k">if</span> <span class="n">flag_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">==</span> <span class="n">flag_obj</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">True</span>
    <span class="c"># Check whether flag_obj is registered under its short name.</span>
    <span class="n">short_name</span> <span class="o">=</span> <span class="n">flag_obj</span><span class="o">.</span><span class="n">short_name</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">short_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span>
        <span class="n">flag_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">short_name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">==</span> <span class="n">flag_obj</span><span class="p">):</span>
      <span class="k">return</span> <span class="bp">True</span>
    <span class="c"># The flag cannot be registered under any other name, so we do not</span>
    <span class="c"># need to do a full search through the values of self.FlagDict().</span>
    <span class="k">return</span> <span class="bp">False</span>

  <span class="k">def</span> <span class="nf">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Deletes a previously-defined flag from a flag object.</span>

<span class="sd">    This method makes sure we can delete a flag by using</span>

<span class="sd">      del flag_values_object.&lt;flag_name&gt;</span>

<span class="sd">    E.g.,</span>

<span class="sd">      gflags.DEFINE_integer(&#39;foo&#39;, 1, &#39;Integer flag.&#39;)</span>
<span class="sd">      del gflags.FLAGS.foo</span>

<span class="sd">    Args:</span>
<span class="sd">      flag_name: A string, the name of the flag to be deleted.</span>

<span class="sd">    Raises:</span>
<span class="sd">      AttributeError: When there is no registered flag named flag_name.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">flag_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">flag_name</span><span class="p">)</span>

    <span class="n">flag_obj</span> <span class="o">=</span> <span class="n">fl</span><span class="p">[</span><span class="n">flag_name</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">fl</span><span class="p">[</span><span class="n">flag_name</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FlagIsRegistered</span><span class="p">(</span><span class="n">flag_obj</span><span class="p">):</span>
      <span class="c"># If the Flag object indicated by flag_name is no longer</span>
      <span class="c"># registered (please see the docstring of _FlagIsRegistered), then</span>
      <span class="c"># we delete the occurrences of the flag object in all our internal</span>
      <span class="c"># dictionaries.</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__RemoveFlagFromDictByModule</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlagsByModuleDict</span><span class="p">(),</span> <span class="n">flag_obj</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__RemoveFlagFromDictByModule</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlagsByModuleIdDict</span><span class="p">(),</span> <span class="n">flag_obj</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__RemoveFlagFromDictByModule</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">KeyFlagsByModuleDict</span><span class="p">(),</span> <span class="n">flag_obj</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__RemoveFlagFromDictByModule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flags_by_module_dict</span><span class="p">,</span> <span class="n">flag_obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Removes a flag object from a module -&gt; list of flags dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">      flags_by_module_dict: A dictionary that maps module names to lists of</span>
<span class="sd">        flags.</span>
<span class="sd">      flag_obj: A flag object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">unused_module</span><span class="p">,</span> <span class="n">flags_in_module</span> <span class="ow">in</span> <span class="n">flags_by_module_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
      <span class="c"># while (as opposed to if) takes care of multiple occurrences of a</span>
      <span class="c"># flag in the list for the same module.</span>
      <span class="k">while</span> <span class="n">flag_obj</span> <span class="ow">in</span> <span class="n">flags_in_module</span><span class="p">:</span>
        <span class="n">flags_in_module</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">flag_obj</span><span class="p">)</span>

<div class="viewcode-block" id="FlagValues.SetDefault"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.SetDefault">[docs]</a>  <span class="k">def</span> <span class="nf">SetDefault</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Changes the default value of the named flag object.&quot;&quot;&quot;</span>
    <span class="n">fl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">fl</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">SetDefault</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_AssertValidators</span><span class="p">(</span><span class="n">fl</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">validators</span><span class="p">)</span>
</div>
  <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns True if name is a value (flag) in the dict.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span>

  <span class="n">has_key</span> <span class="o">=</span> <span class="n">__contains__</span>  <span class="c"># a synonym for __contains__()</span>

  <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">())</span>

  <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argv</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parses flags from argv; stores parsed flags into this FlagValues object.</span>

<span class="sd">    All unparsed arguments are returned.  Flags are parsed using the GNU</span>
<span class="sd">    Program Argument Syntax Conventions, using getopt:</span>

<span class="sd">    http://www.gnu.org/software/libc/manual/html_mono/libc.html#Getopt</span>

<span class="sd">    Args:</span>
<span class="sd">       argv: argument list. Can be of any type that may be converted to a list.</span>

<span class="sd">    Returns:</span>
<span class="sd">       The list of arguments not parsed as options, including argv[0]</span>

<span class="sd">    Raises:</span>
<span class="sd">       FlagsError: on any parsing error</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Support any sequence type that can be converted to a list</span>
    <span class="n">argv</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>

    <span class="n">shortopts</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">longopts</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">fl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span>

    <span class="c"># This pre parses the argv list for --flagfile=&lt;&gt; options.</span>
    <span class="n">argv</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReadFlagsFromFiles</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">force_gnu</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c"># Correct the argv to support the google style of passing boolean</span>
    <span class="c"># parameters.  Boolean parameters may be passed by using --mybool,</span>
    <span class="c"># --nomybool, --mybool=(true|false|1|0).  getopt does not support</span>
    <span class="c"># having options that may or may not have a parameter.  We replace</span>
    <span class="c"># instances of the short form --mybool and --nomybool with their</span>
    <span class="c"># full forms: --mybool=(true|false).</span>
    <span class="n">original_argv</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>  <span class="c"># list() makes a copy</span>
    <span class="n">shortest_matches</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">fl</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="o">.</span><span class="n">boolean</span><span class="p">:</span>
        <span class="k">continue</span>
      <span class="k">if</span> <span class="n">shortest_matches</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># Determine the smallest allowable prefix for all flag names</span>
        <span class="n">shortest_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ShortestUniquePrefixes</span><span class="p">(</span><span class="n">fl</span><span class="p">)</span>
      <span class="n">no_name</span> <span class="o">=</span> <span class="s">&#39;no&#39;</span> <span class="o">+</span> <span class="n">name</span>
      <span class="n">prefix</span> <span class="o">=</span> <span class="n">shortest_matches</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
      <span class="n">no_prefix</span> <span class="o">=</span> <span class="n">shortest_matches</span><span class="p">[</span><span class="n">no_name</span><span class="p">]</span>

      <span class="c"># Replace all occurrences of this boolean with extended forms</span>
      <span class="k">for</span> <span class="n">arg_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">argv</span><span class="p">)):</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="n">arg_idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;=&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
        <span class="k">if</span> <span class="n">arg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;--&#39;</span><span class="o">+</span><span class="n">prefix</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&#39;--&#39;</span><span class="o">+</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
          <span class="n">argv</span><span class="p">[</span><span class="n">arg_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;--</span><span class="si">%s</span><span class="s">=true&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">arg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;--&#39;</span><span class="o">+</span><span class="n">no_prefix</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="s">&#39;--&#39;</span><span class="o">+</span><span class="n">no_name</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
          <span class="n">argv</span><span class="p">[</span><span class="n">arg_idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;--</span><span class="si">%s</span><span class="s">=false&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>

    <span class="c"># Loop over all of the flags, building up the lists of short options</span>
    <span class="c"># and long options that will be passed to getopt.  Short options are</span>
    <span class="c"># specified as a string of letters, each letter followed by a colon</span>
    <span class="c"># if it takes an argument.  Long options are stored in an array of</span>
    <span class="c"># strings.  Each string ends with an &#39;=&#39; if it takes an argument.</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">fl</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
      <span class="n">longopts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot;=&quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c"># one-letter option: allow short flag type also</span>
        <span class="n">shortopts</span> <span class="o">+=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="o">.</span><span class="n">boolean</span><span class="p">:</span>
          <span class="n">shortopts</span> <span class="o">+=</span> <span class="s">&quot;:&quot;</span>

    <span class="n">longopts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;undefok=&#39;</span><span class="p">)</span>
    <span class="n">undefok_flags</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c"># In case --undefok is specified, loop to pick up unrecognized</span>
    <span class="c"># options one by one.</span>
    <span class="n">unrecognized_opts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__use_gnu_getopt&#39;</span><span class="p">]:</span>
          <span class="n">optlist</span><span class="p">,</span> <span class="n">unparsed_args</span> <span class="o">=</span> <span class="n">getopt</span><span class="o">.</span><span class="n">gnu_getopt</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">shortopts</span><span class="p">,</span> <span class="n">longopts</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">optlist</span><span class="p">,</span> <span class="n">unparsed_args</span> <span class="o">=</span> <span class="n">getopt</span><span class="o">.</span><span class="n">getopt</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">shortopts</span><span class="p">,</span> <span class="n">longopts</span><span class="p">)</span>
        <span class="k">break</span>
      <span class="k">except</span> <span class="n">getopt</span><span class="o">.</span><span class="n">GetoptError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">e</span><span class="o">.</span><span class="n">opt</span> <span class="ow">or</span> <span class="n">e</span><span class="o">.</span><span class="n">opt</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">:</span>
          <span class="c"># Not an unrecognized option, re-raise the exception as a FlagsError</span>
          <span class="k">raise</span> <span class="n">FlagsError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="c"># Remove offender from args and try again</span>
        <span class="k">for</span> <span class="n">arg_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)):</span>
          <span class="k">if</span> <span class="p">((</span><span class="n">args</span><span class="p">[</span><span class="n">arg_index</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;--&#39;</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">opt</span><span class="p">)</span> <span class="ow">or</span>
              <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">arg_index</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;-&#39;</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">opt</span><span class="p">)</span> <span class="ow">or</span>
              <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">arg_index</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;--&#39;</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">opt</span> <span class="o">+</span> <span class="s">&#39;=&#39;</span><span class="p">))):</span>
            <span class="n">unrecognized_opts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">e</span><span class="o">.</span><span class="n">opt</span><span class="p">,</span> <span class="n">args</span><span class="p">[</span><span class="n">arg_index</span><span class="p">]))</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">arg_index</span><span class="p">]</span> <span class="o">+</span> <span class="n">args</span><span class="p">[</span><span class="n">arg_index</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="c"># We should have found the option, so we don&#39;t expect to get</span>
          <span class="c"># here.  We could assert, but raising the original exception</span>
          <span class="c"># might work better.</span>
          <span class="k">raise</span> <span class="n">FlagsError</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">optlist</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s">&#39;--undefok&#39;</span><span class="p">:</span>
        <span class="n">flag_names</span> <span class="o">=</span> <span class="n">arg</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">undefok_flags</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">flag_names</span><span class="p">)</span>
        <span class="c"># For boolean flags, if --undefok=boolflag is specified, then we should</span>
        <span class="c"># also accept --noboolflag, in addition to --boolflag.</span>
        <span class="c"># Since we don&#39;t know the type of the undefok&#39;d flag, this will affect</span>
        <span class="c"># non-boolean flags as well.</span>
        <span class="c"># NOTE: You shouldn&#39;t use --undefok=noboolflag, because then we will</span>
        <span class="c"># accept --nonoboolflag here.  We are choosing not to do the conversion</span>
        <span class="c"># from noboolflag -&gt; boolflag because of the ambiguity that flag names</span>
        <span class="c"># can start with &#39;no&#39;.</span>
        <span class="n">undefok_flags</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="s">&#39;no&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">flag_names</span><span class="p">)</span>
        <span class="k">continue</span>
      <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;--&#39;</span><span class="p">):</span>
        <span class="c"># long option</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
        <span class="n">short_option</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c"># short option</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">short_option</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">:</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="n">fl</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">boolean</span> <span class="ow">and</span> <span class="n">short_option</span><span class="p">:</span> <span class="n">arg</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">flag</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

    <span class="c"># If there were unrecognized options, raise an exception unless</span>
    <span class="c"># the options were named via --undefok.</span>
    <span class="k">for</span> <span class="n">opt</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">unrecognized_opts</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">opt</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">undefok_flags</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">UnrecognizedFlagError</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">unparsed_args</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__use_gnu_getopt&#39;</span><span class="p">]:</span>
        <span class="c"># if using gnu_getopt just return the program name + remainder of argv.</span>
        <span class="n">ret_val</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">unparsed_args</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c"># unparsed_args becomes the first non-flag detected by getopt to</span>
        <span class="c"># the end of argv.  Because argv may have been modified above,</span>
        <span class="c"># return original_argv for this region.</span>
        <span class="n">ret_val</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">original_argv</span><span class="p">[</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">unparsed_args</span><span class="p">):]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">ret_val</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_AssertAllValidators</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ret_val</span>

<div class="viewcode-block" id="FlagValues.Reset"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.Reset">[docs]</a>  <span class="k">def</span> <span class="nf">Reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Resets the values to the point before FLAGS(argv) was called.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
      <span class="n">f</span><span class="o">.</span><span class="n">Unparse</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="FlagValues.RegisteredFlags"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.RegisteredFlags">[docs]</a>  <span class="k">def</span> <span class="nf">RegisteredFlags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns: a list of the names and short names of all registered flags.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="FlagValues.FlagValuesDict"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.FlagValuesDict">[docs]</a>  <span class="k">def</span> <span class="nf">FlagValuesDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns: a dictionary that maps flag names to flag values.&quot;&quot;&quot;</span>
    <span class="n">flag_values</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">flag_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">RegisteredFlags</span><span class="p">():</span>
      <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()[</span><span class="n">flag_name</span><span class="p">]</span>
      <span class="n">flag_values</span><span class="p">[</span><span class="n">flag_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span><span class="o">.</span><span class="n">value</span>

    <span class="k">return</span> <span class="n">flag_values</span>
</div>
  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a help string for all known flags.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetHelp</span><span class="p">()</span>

<div class="viewcode-block" id="FlagValues.GetHelp"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.GetHelp">[docs]</a>  <span class="k">def</span> <span class="nf">GetHelp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a help string for all known flags.&quot;&quot;&quot;</span>
    <span class="n">helplist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">flags_by_module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagsByModuleDict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">flags_by_module</span><span class="p">:</span>

      <span class="n">modules</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">flags_by_module</span><span class="p">)</span>

      <span class="c"># Print the help for the main module first, if possible.</span>
      <span class="n">main_module</span> <span class="o">=</span> <span class="n">_GetMainModule</span><span class="p">()</span>
      <span class="k">if</span> <span class="n">main_module</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
        <span class="n">modules</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">main_module</span><span class="p">)</span>
        <span class="n">modules</span> <span class="o">=</span> <span class="p">[</span><span class="n">main_module</span><span class="p">]</span> <span class="o">+</span> <span class="n">modules</span>

      <span class="k">for</span> <span class="n">module</span> <span class="ow">in</span> <span class="n">modules</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__RenderOurModuleFlags</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">helplist</span><span class="p">)</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">__RenderModuleFlags</span><span class="p">(</span><span class="s">&#39;gflags&#39;</span><span class="p">,</span>
                               <span class="n">_SPECIAL_FLAGS</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
                               <span class="n">helplist</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
      <span class="c"># Just print one long list of flags.</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__RenderFlagList</span><span class="p">(</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="o">+</span> <span class="n">_SPECIAL_FLAGS</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
          <span class="n">helplist</span><span class="p">,</span> <span class="n">prefix</span><span class="p">)</span>

    <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">helplist</span><span class="p">)</span>
</div>
  <span class="k">def</span> <span class="nf">__RenderModuleFlags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">output_lines</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a help string for a given module.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
      <span class="n">module</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">__name__</span>
    <span class="n">output_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="si">%s%s</span><span class="s">:&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">module</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__RenderFlagList</span><span class="p">(</span><span class="n">flags</span><span class="p">,</span> <span class="n">output_lines</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s">&quot;  &quot;</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__RenderOurModuleFlags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">output_lines</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a help string for a given module.&quot;&quot;&quot;</span>
    <span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetFlagsDefinedByModule</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">flags</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__RenderModuleFlags</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">output_lines</span><span class="p">,</span> <span class="n">prefix</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__RenderOurModuleKeyFlags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">output_lines</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a help string for the key flags of a given module.</span>

<span class="sd">    Args:</span>
<span class="sd">      module: A module object or a module name (a string).</span>
<span class="sd">      output_lines: A list of strings.  The generated help message</span>
<span class="sd">        lines will be appended to this list.</span>
<span class="sd">      prefix: A string that is prepended to each generated help line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key_flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetKeyFlagsForModule</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">key_flags</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">__RenderModuleFlags</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">key_flags</span><span class="p">,</span> <span class="n">output_lines</span><span class="p">,</span> <span class="n">prefix</span><span class="p">)</span>

<div class="viewcode-block" id="FlagValues.ModuleHelp"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.ModuleHelp">[docs]</a>  <span class="k">def</span> <span class="nf">ModuleHelp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">module</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Describe the key flags of a module.</span>

<span class="sd">    Args:</span>
<span class="sd">      module: A module object or a module name (a string).</span>

<span class="sd">    Returns:</span>
<span class="sd">      string describing the key flags of a module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">helplist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__RenderOurModuleKeyFlags</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">helplist</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">helplist</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FlagValues.MainModuleHelp"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.MainModuleHelp">[docs]</a>  <span class="k">def</span> <span class="nf">MainModuleHelp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Describe the key flags of the main module.</span>

<span class="sd">    Returns:</span>
<span class="sd">      string describing the key flags of a module.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ModuleHelp</span><span class="p">(</span><span class="n">_GetMainModule</span><span class="p">())</span>
</div>
  <span class="k">def</span> <span class="nf">__RenderFlagList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flaglist</span><span class="p">,</span> <span class="n">output_lines</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;  &quot;</span><span class="p">):</span>
    <span class="n">fl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span>
    <span class="n">special_fl</span> <span class="o">=</span> <span class="n">_SPECIAL_FLAGS</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span>
    <span class="n">flaglist</span> <span class="o">=</span> <span class="p">[(</span><span class="n">flag</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span> <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flaglist</span><span class="p">]</span>
    <span class="n">flaglist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">flagset</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span> <span class="ow">in</span> <span class="n">flaglist</span><span class="p">:</span>
      <span class="c"># It&#39;s possible this flag got deleted or overridden since being</span>
      <span class="c"># registered in the per-module flaglist.  Check now against the</span>
      <span class="c"># canonical source of current flag information, the FlagDict.</span>
      <span class="k">if</span> <span class="n">fl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="n">flag</span> <span class="ow">and</span> <span class="n">special_fl</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span> <span class="o">!=</span> <span class="n">flag</span><span class="p">:</span>
        <span class="c"># a different flag is using this name now</span>
        <span class="k">continue</span>
      <span class="c"># only print help once</span>
      <span class="k">if</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flagset</span><span class="p">:</span> <span class="k">continue</span>
      <span class="n">flagset</span><span class="p">[</span><span class="n">flag</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">flaghelp</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
      <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">short_name</span><span class="p">:</span> <span class="n">flaghelp</span> <span class="o">+=</span> <span class="s">&quot;-</span><span class="si">%s</span><span class="s">,&quot;</span> <span class="o">%</span> <span class="n">flag</span><span class="o">.</span><span class="n">short_name</span>
      <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">boolean</span><span class="p">:</span>
        <span class="n">flaghelp</span> <span class="o">+=</span> <span class="s">&quot;--[no]</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">flag</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">flaghelp</span> <span class="o">+=</span> <span class="s">&quot;--</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">flag</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span>
      <span class="n">flaghelp</span> <span class="o">+=</span> <span class="s">&quot;  &quot;</span>
      <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">help</span><span class="p">:</span>
        <span class="n">flaghelp</span> <span class="o">+=</span> <span class="n">flag</span><span class="o">.</span><span class="n">help</span>
      <span class="n">flaghelp</span> <span class="o">=</span> <span class="n">TextWrap</span><span class="p">(</span><span class="n">flaghelp</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">prefix</span><span class="o">+</span><span class="s">&quot;  &quot;</span><span class="p">,</span>
                          <span class="n">firstline_indent</span><span class="o">=</span><span class="n">prefix</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">default_as_str</span><span class="p">:</span>
        <span class="n">flaghelp</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="n">flaghelp</span> <span class="o">+=</span> <span class="n">TextWrap</span><span class="p">(</span><span class="s">&quot;(default: </span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">flag</span><span class="o">.</span><span class="n">default_as_str</span><span class="p">,</span>
                             <span class="n">indent</span><span class="o">=</span><span class="n">prefix</span><span class="o">+</span><span class="s">&quot;  &quot;</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">syntactic_help</span><span class="p">:</span>
        <span class="n">flaghelp</span> <span class="o">+=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="n">flaghelp</span> <span class="o">+=</span> <span class="n">TextWrap</span><span class="p">(</span><span class="s">&quot;(</span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">flag</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">syntactic_help</span><span class="p">,</span>
                             <span class="n">indent</span><span class="o">=</span><span class="n">prefix</span><span class="o">+</span><span class="s">&quot;  &quot;</span><span class="p">)</span>
      <span class="n">output_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flaghelp</span><span class="p">)</span>

<div class="viewcode-block" id="FlagValues.get"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.get">[docs]</a>  <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the value of a flag (if not None) or a default value.</span>

<span class="sd">    Args:</span>
<span class="sd">      name: A string, the name of a flag.</span>
<span class="sd">      default: Default value to use if the flag value is None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getattr__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># Can&#39;t do if not value, b/c value might be &#39;0&#39; or &quot;&quot;</span>
      <span class="k">return</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="n">default</span>
</div>
<div class="viewcode-block" id="FlagValues.ShortestUniquePrefixes"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.ShortestUniquePrefixes">[docs]</a>  <span class="k">def</span> <span class="nf">ShortestUniquePrefixes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fl</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns: dictionary; maps flag names to their shortest unique prefix.&quot;&quot;&quot;</span>
    <span class="c"># Sort the list of flag names</span>
    <span class="n">sorted_flags</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">fl</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
      <span class="n">sorted_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">boolean</span><span class="p">:</span>
        <span class="n">sorted_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;no</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">sorted_flags</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="c"># For each name in the sorted list, determine the shortest unique</span>
    <span class="c"># prefix by comparing itself to the next name and to the previous</span>
    <span class="c"># name (the latter check uses cached info from the previous loop).</span>
    <span class="n">shortest_matches</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">prev_idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">flag_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_flags</span><span class="p">)):</span>
      <span class="n">curr</span> <span class="o">=</span> <span class="n">sorted_flags</span><span class="p">[</span><span class="n">flag_idx</span><span class="p">]</span>
      <span class="k">if</span> <span class="n">flag_idx</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_flags</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">next</span> <span class="o">=</span> <span class="bp">None</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="nb">next</span> <span class="o">=</span> <span class="n">sorted_flags</span><span class="p">[</span><span class="n">flag_idx</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">next_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">next</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">curr_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">curr</span><span class="p">)):</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">next</span> <span class="ow">is</span> <span class="bp">None</span>
            <span class="ow">or</span> <span class="n">curr_idx</span> <span class="o">&gt;=</span> <span class="n">next_len</span>
            <span class="ow">or</span> <span class="n">curr</span><span class="p">[</span><span class="n">curr_idx</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">next</span><span class="p">[</span><span class="n">curr_idx</span><span class="p">]):</span>
          <span class="c"># curr longer than next or no more chars in common</span>
          <span class="n">shortest_matches</span><span class="p">[</span><span class="n">curr</span><span class="p">]</span> <span class="o">=</span> <span class="n">curr</span><span class="p">[:</span><span class="nb">max</span><span class="p">(</span><span class="n">prev_idx</span><span class="p">,</span> <span class="n">curr_idx</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
          <span class="n">prev_idx</span> <span class="o">=</span> <span class="n">curr_idx</span>
          <span class="k">break</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c"># curr shorter than (or equal to) next</span>
        <span class="n">shortest_matches</span><span class="p">[</span><span class="n">curr</span><span class="p">]</span> <span class="o">=</span> <span class="n">curr</span>
        <span class="n">prev_idx</span> <span class="o">=</span> <span class="n">curr_idx</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c"># next will need at least one more char</span>
    <span class="k">return</span> <span class="n">shortest_matches</span>
</div>
  <span class="k">def</span> <span class="nf">__IsFlagFileDirective</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag_string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks whether flag_string contain a --flagfile=&lt;foo&gt; directive.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flag_string</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)):</span>
      <span class="k">if</span> <span class="n">flag_string</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;--flagfile=&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>
      <span class="k">elif</span> <span class="n">flag_string</span> <span class="o">==</span> <span class="s">&#39;--flagfile&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
      <span class="k">elif</span> <span class="n">flag_string</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;-flagfile=&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>
      <span class="k">elif</span> <span class="n">flag_string</span> <span class="o">==</span> <span class="s">&#39;-flagfile&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="mi">0</span>

<div class="viewcode-block" id="FlagValues.ExtractFilename"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.ExtractFilename">[docs]</a>  <span class="k">def</span> <span class="nf">ExtractFilename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flagfile_str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns filename from a flagfile_str of form -[-]flagfile=filename.</span>

<span class="sd">    The cases of --flagfile foo and -flagfile foo shouldn&#39;t be hitting</span>
<span class="sd">    this function, as they are dealt with in the level above this</span>
<span class="sd">    function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">flagfile_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;--flagfile=&#39;</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">((</span><span class="n">flagfile_str</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="s">&#39;--flagfile=&#39;</span><span class="p">)):])</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">elif</span> <span class="n">flagfile_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;-flagfile=&#39;</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">((</span><span class="n">flagfile_str</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="s">&#39;-flagfile=&#39;</span><span class="p">)):])</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">FlagsError</span><span class="p">(</span><span class="s">&#39;Hit illegal --flagfile type: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">flagfile_str</span><span class="p">)</span>
</div>
  <span class="k">def</span> <span class="nf">__GetFlagFileLines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">parsed_file_list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the useful (!=comments, etc) lines from a file with flags.</span>

<span class="sd">    Args:</span>
<span class="sd">      filename: A string, the name of the flag file.</span>
<span class="sd">      parsed_file_list: A list of the names of the files we have</span>
<span class="sd">        already read.  MUTATED BY THIS FUNCTION.</span>

<span class="sd">    Returns:</span>
<span class="sd">      List of strings. See the note below.</span>

<span class="sd">    NOTE(springer): This function checks for a nested --flagfile=&lt;foo&gt;</span>
<span class="sd">    tag and handles the lower file recursively. It returns a list of</span>
<span class="sd">    all the lines that _could_ contain command flags. This is</span>
<span class="sd">    EVERYTHING except whitespace lines and comments (lines starting</span>
<span class="sd">    with &#39;#&#39; or &#39;//&#39;).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">line_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># All line from flagfile.</span>
    <span class="n">flag_line_list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c"># Subset of lines w/o comments, blanks, flagfile= tags.</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">file_obj</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IOError</span><span class="p">,</span> <span class="n">e_msg</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">CantOpenFlagFileError</span><span class="p">(</span><span class="s">&#39;ERROR:: Unable to open flagfile: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">e_msg</span><span class="p">)</span>

    <span class="n">line_list</span> <span class="o">=</span> <span class="n">file_obj</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">file_obj</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">parsed_file_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="c"># This is where we check each line in the file we just read.</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">line_list</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
        <span class="k">pass</span>
      <span class="c"># Checks for comment (a line that starts with &#39;#&#39;).</span>
      <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;#&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;//&#39;</span><span class="p">):</span>
        <span class="k">pass</span>
      <span class="c"># Checks for a nested &quot;--flagfile=&lt;bar&gt;&quot; flag in the current file.</span>
      <span class="c"># If we find one, recursively parse down into that file.</span>
      <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">__IsFlagFileDirective</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
        <span class="n">sub_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExtractFilename</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="c"># We do a little safety check for reparsing a file we&#39;ve already done.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sub_filename</span> <span class="ow">in</span> <span class="n">parsed_file_list</span><span class="p">:</span>
          <span class="n">included_flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__GetFlagFileLines</span><span class="p">(</span><span class="n">sub_filename</span><span class="p">,</span>
                                                   <span class="n">parsed_file_list</span><span class="p">)</span>
          <span class="n">flag_line_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">included_flags</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># Case of hitting a circularly included file.</span>
          <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;Warning: Hit circular flagfile dependency: </span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span>
                           <span class="p">(</span><span class="n">sub_filename</span><span class="p">,))</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c"># Any line that&#39;s not a comment or a nested flagfile should get</span>
        <span class="c"># copied into 2nd position.  This leaves earlier arguments</span>
        <span class="c"># further back in the list, thus giving them higher priority.</span>
        <span class="n">flag_line_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">flag_line_list</span>

<div class="viewcode-block" id="FlagValues.ReadFlagsFromFiles"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.ReadFlagsFromFiles">[docs]</a>  <span class="k">def</span> <span class="nf">ReadFlagsFromFiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="n">force_gnu</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Processes command line args, but also allow args to be read from file.</span>

<span class="sd">    Args:</span>
<span class="sd">      argv: A list of strings, usually sys.argv[1:], which may contain one or</span>
<span class="sd">        more flagfile directives of the form --flagfile=&quot;./filename&quot;.</span>
<span class="sd">        Note that the name of the program (sys.argv[0]) should be omitted.</span>
<span class="sd">      force_gnu: If False, --flagfile parsing obeys normal flag semantics.</span>
<span class="sd">        If True, --flagfile parsing instead follows gnu_getopt semantics.</span>
<span class="sd">        *** WARNING *** force_gnu=False may become the future default!</span>

<span class="sd">    Returns:</span>

<span class="sd">      A new list which has the original list combined with what we read</span>
<span class="sd">      from any flagfile(s).</span>

<span class="sd">    References: Global gflags.FLAG class instance.</span>

<span class="sd">    This function should be called before the normal FLAGS(argv) call.</span>
<span class="sd">    This function scans the input list for a flag that looks like:</span>
<span class="sd">    --flagfile=&lt;somefile&gt;. Then it opens &lt;somefile&gt;, reads all valid key</span>
<span class="sd">    and value pairs and inserts them into the input list between the</span>
<span class="sd">    first item of the list and any subsequent items in the list.</span>

<span class="sd">    Note that your application&#39;s flags are still defined the usual way</span>
<span class="sd">    using gflags DEFINE_flag() type functions.</span>

<span class="sd">    Notes (assuming we&#39;re getting a commandline of some sort as our input):</span>
<span class="sd">    --&gt; Flags from the command line argv _should_ always take precedence!</span>
<span class="sd">    --&gt; A further &quot;--flagfile=&lt;otherfile.cfg&gt;&quot; CAN be nested in a flagfile.</span>
<span class="sd">        It will be processed after the parent flag file is done.</span>
<span class="sd">    --&gt; For duplicate flags, first one we hit should &quot;win&quot;.</span>
<span class="sd">    --&gt; In a flagfile, a line beginning with # or // is a comment.</span>
<span class="sd">    --&gt; Entirely blank lines _should_ be ignored.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parsed_file_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">rest_of_args</span> <span class="o">=</span> <span class="n">argv</span>
    <span class="n">new_argv</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">rest_of_args</span><span class="p">:</span>
      <span class="n">current_arg</span> <span class="o">=</span> <span class="n">rest_of_args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">rest_of_args</span> <span class="o">=</span> <span class="n">rest_of_args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__IsFlagFileDirective</span><span class="p">(</span><span class="n">current_arg</span><span class="p">):</span>
        <span class="c"># This handles the case of -(-)flagfile foo.  In this case the</span>
        <span class="c"># next arg really is part of this one.</span>
        <span class="k">if</span> <span class="n">current_arg</span> <span class="o">==</span> <span class="s">&#39;--flagfile&#39;</span> <span class="ow">or</span> <span class="n">current_arg</span> <span class="o">==</span> <span class="s">&#39;-flagfile&#39;</span><span class="p">:</span>
          <span class="k">if</span> <span class="ow">not</span> <span class="n">rest_of_args</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">IllegalFlagValue</span><span class="p">(</span><span class="s">&#39;--flagfile with no argument&#39;</span><span class="p">)</span>
          <span class="n">flag_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">rest_of_args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
          <span class="n">rest_of_args</span> <span class="o">=</span> <span class="n">rest_of_args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="c"># This handles the case of (-)-flagfile=foo.</span>
          <span class="n">flag_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ExtractFilename</span><span class="p">(</span><span class="n">current_arg</span><span class="p">)</span>
        <span class="n">new_argv</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__GetFlagFileLines</span><span class="p">(</span><span class="n">flag_filename</span><span class="p">,</span> <span class="n">parsed_file_list</span><span class="p">))</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">new_argv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_arg</span><span class="p">)</span>
        <span class="c"># Stop parsing after &#39;--&#39;, like getopt and gnu_getopt.</span>
        <span class="k">if</span> <span class="n">current_arg</span> <span class="o">==</span> <span class="s">&#39;--&#39;</span><span class="p">:</span>
          <span class="k">break</span>
        <span class="c"># Stop parsing after a non-flag, like getopt.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">current_arg</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">):</span>
          <span class="k">if</span> <span class="ow">not</span> <span class="n">force_gnu</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__use_gnu_getopt&#39;</span><span class="p">]:</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">rest_of_args</span><span class="p">:</span>
      <span class="n">new_argv</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">rest_of_args</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_argv</span>
</div>
<div class="viewcode-block" id="FlagValues.FlagsIntoString"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.FlagsIntoString">[docs]</a>  <span class="k">def</span> <span class="nf">FlagsIntoString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a string with the flags assignments from this FlagValues object.</span>

<span class="sd">    This function ignores flags whose value is None.  Each flag</span>
<span class="sd">    assignment is separated by a newline.</span>

<span class="sd">    NOTE: MUST mirror the behavior of the C++ CommandlineFlagsIntoString</span>
<span class="sd">    from http://code.google.com/p/google-gflags</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">flag</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">flag</span><span class="o">.</span><span class="n">Serialize</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="k">return</span> <span class="n">s</span>
</div>
<div class="viewcode-block" id="FlagValues.AppendFlagsIntoFile"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.AppendFlagsIntoFile">[docs]</a>  <span class="k">def</span> <span class="nf">AppendFlagsIntoFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Appends all flags assignments from this FlagInfo object to a file.</span>

<span class="sd">    Output will be in the format of a flagfile.</span>

<span class="sd">    NOTE: MUST mirror the behavior of the C++ AppendFlagsIntoFile</span>
<span class="sd">    from http://code.google.com/p/google-gflags</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">)</span>
    <span class="n">out_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FlagsIntoString</span><span class="p">())</span>
    <span class="n">out_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="FlagValues.WriteHelpInXMLFormat"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.WriteHelpInXMLFormat">[docs]</a>  <span class="k">def</span> <span class="nf">WriteHelpInXMLFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Outputs flag documentation in XML format.</span>

<span class="sd">    NOTE: We use element names that are consistent with those used by</span>
<span class="sd">    the C++ command-line flag library, from</span>
<span class="sd">    http://code.google.com/p/google-gflags</span>
<span class="sd">    We also use a few new elements (e.g., &lt;key&gt;), but we do not</span>
<span class="sd">    interfere / overlap with existing XML elements used by the C++</span>
<span class="sd">    library.  Please maintain this consistency.</span>

<span class="sd">    Args:</span>
<span class="sd">      outfile: File object we write to.  Default None means sys.stdout.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">outfile</span> <span class="o">=</span> <span class="n">outfile</span> <span class="ow">or</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&lt;?xml version=</span><span class="se">\&quot;</span><span class="s">1.0</span><span class="se">\&quot;</span><span class="s">?&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&lt;AllFlags&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="s">&#39;  &#39;</span>
    <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;program&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                           <span class="n">indent</span><span class="p">)</span>

    <span class="n">usage_doc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&#39;__main__&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">__doc__</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">usage_doc</span><span class="p">:</span>
      <span class="n">usage_doc</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">USAGE: </span><span class="si">%s</span><span class="s"> [flags]</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">usage_doc</span> <span class="o">=</span> <span class="n">usage_doc</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;usage&#39;</span><span class="p">,</span> <span class="n">usage_doc</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>

    <span class="c"># Get list of key flags for the main module.</span>
    <span class="n">key_flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetKeyFlagsForModule</span><span class="p">(</span><span class="n">_GetMainModule</span><span class="p">())</span>

    <span class="c"># Sort flags by declaring module name and next by flag name.</span>
    <span class="n">flags_by_module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagsByModuleDict</span><span class="p">()</span>
    <span class="n">all_module_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flags_by_module</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">all_module_names</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">module_name</span> <span class="ow">in</span> <span class="n">all_module_names</span><span class="p">:</span>
      <span class="n">flag_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">flags_by_module</span><span class="p">[</span><span class="n">module_name</span><span class="p">]]</span>
      <span class="n">flag_list</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
      <span class="k">for</span> <span class="n">unused_flag_name</span><span class="p">,</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">flag_list</span><span class="p">:</span>
        <span class="n">is_key</span> <span class="o">=</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">key_flags</span>
        <span class="n">flag</span><span class="o">.</span><span class="n">WriteInfoInXMLFormat</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span>
                                  <span class="n">is_key</span><span class="o">=</span><span class="n">is_key</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">indent</span><span class="p">)</span>

    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;&lt;/AllFlags&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">outfile</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="FlagValues.AddValidator"><a class="viewcode-back" href="../../lib.html#lib.gflags.FlagValues.AddValidator">[docs]</a>  <span class="k">def</span> <span class="nf">AddValidator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">validator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Register new flags validator to be checked.</span>

<span class="sd">    Args:</span>
<span class="sd">      validator: gflags_validators.Validator</span>
<span class="sd">    Raises:</span>
<span class="sd">      AttributeError: if validators work with a non-existing flag.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">flag_name</span> <span class="ow">in</span> <span class="n">validator</span><span class="o">.</span><span class="n">GetFlagsNames</span><span class="p">():</span>
      <span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()[</span><span class="n">flag_name</span><span class="p">]</span>
      <span class="n">flag</span><span class="o">.</span><span class="n">validators</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">validator</span><span class="p">)</span>

<span class="c"># end of FlagValues definition</span>


<span class="c"># The global FlagValues instance</span></div></div>
<span class="n">FLAGS</span> <span class="o">=</span> <span class="n">FlagValues</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_StrOrUnicode</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Converts value to a python string or, if necessary, unicode-string.&quot;&quot;&quot;</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
  <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_MakeXMLSafe</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Escapes &lt;, &gt;, and &amp; from s, and removes XML 1.0-illegal chars.&quot;&quot;&quot;</span>
  <span class="n">s</span> <span class="o">=</span> <span class="n">cgi</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="c"># Escape &lt;, &gt;, and &amp;</span>
  <span class="c"># Remove characters that cannot appear in an XML 1.0 document</span>
  <span class="c"># (http://www.w3.org/TR/REC-xml/#charsets).</span>
  <span class="c">#</span>
  <span class="c"># NOTE: if there are problems with current solution, one may move to</span>
  <span class="c"># XML 1.1, which allows such chars, if they&#39;re entity-escaped (&amp;#xHH;).</span>
  <span class="n">s</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;[\x00-\x08\x0b\x0c\x0e-\x1f]&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
  <span class="c"># Convert non-ascii characters to entities.  Note: requires python &gt;=2.3</span>
  <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;ascii&#39;</span><span class="p">,</span> <span class="s">&#39;xmlcharrefreplace&#39;</span><span class="p">)</span>   <span class="c"># u&#39;\xce\x88&#39; -&gt; &#39;u&amp;#904;&#39;</span>
  <span class="k">return</span> <span class="n">s</span>


<span class="k">def</span> <span class="nf">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">indent</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Writes a simple XML element.</span>

<span class="sd">  Args:</span>
<span class="sd">    outfile: File object we write the XML element to.</span>
<span class="sd">    name: A string, the name of XML element.</span>
<span class="sd">    value: A Python object, whose string representation will be used</span>
<span class="sd">      as the value of the XML element.</span>
<span class="sd">    indent: A string, prepended to each line of generated output.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">value_str</span> <span class="o">=</span> <span class="n">_StrOrUnicode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
    <span class="c"># Display boolean values as the C++ flag library does: no caps.</span>
    <span class="n">value_str</span> <span class="o">=</span> <span class="n">value_str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  <span class="n">safe_value_str</span> <span class="o">=</span> <span class="n">_MakeXMLSafe</span><span class="p">(</span><span class="n">value_str</span><span class="p">)</span>
  <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">&lt;</span><span class="si">%s</span><span class="s">&gt;</span><span class="si">%s</span><span class="s">&lt;/</span><span class="si">%s</span><span class="s">&gt;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">indent</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">safe_value_str</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>


<div class="viewcode-block" id="Flag"><a class="viewcode-back" href="../../lib.html#lib.gflags.Flag">[docs]</a><span class="k">class</span> <span class="nc">Flag</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;Information about a command-line flag.</span>

<span class="sd">  &#39;Flag&#39; objects define the following fields:</span>
<span class="sd">    .name  - the name for this flag</span>
<span class="sd">    .default - the default value for this flag</span>
<span class="sd">    .default_as_str - default value as repr&#39;d string, e.g., &quot;&#39;true&#39;&quot; (or None)</span>
<span class="sd">    .value  - the most recent parsed value of this flag; set by Parse()</span>
<span class="sd">    .help  - a help string or None if no help is available</span>
<span class="sd">    .short_name  - the single letter alias for this flag (or None)</span>
<span class="sd">    .boolean  - if &#39;true&#39;, this flag does not accept arguments</span>
<span class="sd">    .present  - true if this flag was parsed from command line flags.</span>
<span class="sd">    .parser  - an ArgumentParser object</span>
<span class="sd">    .serializer - an ArgumentSerializer object</span>
<span class="sd">    .allow_override - the flag may be redefined without raising an error</span>

<span class="sd">  The only public method of a &#39;Flag&#39; object is Parse(), but it is</span>
<span class="sd">  typically only called by a &#39;FlagValues&#39; object.  The Parse() method is</span>
<span class="sd">  a thin wrapper around the &#39;ArgumentParser&#39; Parse() method.  The parsed</span>
<span class="sd">  value is saved in .value, and the .present attribute is updated.  If</span>
<span class="sd">  this flag was already present, a FlagsError is raised.</span>

<span class="sd">  Parse() is also called during __init__ to parse the default value and</span>
<span class="sd">  initialize the .value attribute.  This enables other python modules to</span>
<span class="sd">  safely use flags even if the __main__ module neglects to parse the</span>
<span class="sd">  command line arguments.  The .present attribute is cleared after</span>
<span class="sd">  __init__ parsing.  If the default value is set to None, then the</span>
<span class="sd">  __init__ parsing step is skipped and the .value attribute is</span>
<span class="sd">  initialized to None.</span>

<span class="sd">  Note: The default value is also presented to the user in the help</span>
<span class="sd">  string, so it is important that it be a legal value for this flag.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help_string</span><span class="p">,</span>
               <span class="n">short_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">boolean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_override</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">help_string</span><span class="p">:</span>
      <span class="n">help_string</span> <span class="o">=</span> <span class="s">&#39;(no help available)&#39;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">help</span> <span class="o">=</span> <span class="n">help_string</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">short_name</span> <span class="o">=</span> <span class="n">short_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">boolean</span> <span class="o">=</span> <span class="n">boolean</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">present</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parser</span> <span class="o">=</span> <span class="n">parser</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">serializer</span> <span class="o">=</span> <span class="n">serializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">allow_override</span> <span class="o">=</span> <span class="n">allow_override</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">validators</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">SetDefault</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

  <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">other</span>

  <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Flag</span><span class="p">):</span>
      <span class="k">return</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">id</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">NotImplemented</span>

  <span class="k">def</span> <span class="nf">__GetParsedValueAsString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serializer</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">Serialize</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">boolean</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="s">&#39;true&#39;</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="s">&#39;false&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="n">_StrOrUnicode</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

<div class="viewcode-block" id="Flag.Parse"><a class="viewcode-back" href="../../lib.html#lib.gflags.Flag.Parse">[docs]</a>  <span class="k">def</span> <span class="nf">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>  <span class="c"># recast ValueError as IllegalFlagValue</span>
      <span class="k">raise</span> <span class="n">IllegalFlagValue</span><span class="p">(</span><span class="s">&quot;flag --</span><span class="si">%s</span><span class="s">=</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">argument</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">present</span> <span class="o">+=</span> <span class="mi">1</span>
</div>
<div class="viewcode-block" id="Flag.Unparse"><a class="viewcode-back" href="../../lib.html#lib.gflags.Flag.Unparse">[docs]</a>  <span class="k">def</span> <span class="nf">Unparse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">present</span> <span class="o">=</span> <span class="mi">0</span>
</div>
<div class="viewcode-block" id="Flag.Serialize"><a class="viewcode-back" href="../../lib.html#lib.gflags.Flag.Serialize">[docs]</a>  <span class="k">def</span> <span class="nf">Serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&#39;&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">boolean</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&quot;--</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&quot;--no</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">serializer</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">FlagsError</span><span class="p">(</span><span class="s">&quot;Serializer not present for flag </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
      <span class="k">return</span> <span class="s">&quot;--</span><span class="si">%s</span><span class="s">=</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">Serialize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Flag.SetDefault"><a class="viewcode-back" href="../../lib.html#lib.gflags.Flag.SetDefault">[docs]</a>  <span class="k">def</span> <span class="nf">SetDefault</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Changes the default value (and current value too) for this Flag.&quot;&quot;&quot;</span>
    <span class="c"># We can&#39;t allow a None override because it may end up not being</span>
    <span class="c"># passed to C++ code when we&#39;re overriding C++ flags.  So we</span>
    <span class="c"># cowardly bail out until someone fixes the semantics of trying to</span>
    <span class="c"># pass None to a C++ flag.  See swig_flags.Init() for details on</span>
    <span class="c"># this behavior.</span>
    <span class="c"># TODO(olexiy): Users can directly call this method, bypassing all flags</span>
    <span class="c"># validators (we don&#39;t have FlagValues here, so we can not check</span>
    <span class="c"># validators).</span>
    <span class="c"># The simplest solution I see is to make this method private.</span>
    <span class="c"># Another approach would be to store reference to the corresponding</span>
    <span class="c"># FlagValues with each flag, but this seems to be an overkill.</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_override</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">DuplicateFlagCannotPropagateNoneToSwig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="n">value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Unparse</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">default_as_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__GetParsedValueAsString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Flag.Type"><a class="viewcode-back" href="../../lib.html#lib.gflags.Flag.Type">[docs]</a>  <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns: a string that describes the type of this Flag.&quot;&quot;&quot;</span>
    <span class="c"># NOTE: we use strings, and not the types.*Type constants because</span>
    <span class="c"># our flags can have more exotic types, e.g., &#39;comma separated list</span>
    <span class="c"># of strings&#39;, &#39;whitespace separated list of strings&#39;, etc.</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">Type</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Flag.WriteInfoInXMLFormat"><a class="viewcode-back" href="../../lib.html#lib.gflags.Flag.WriteInfoInXMLFormat">[docs]</a>  <span class="k">def</span> <span class="nf">WriteInfoInXMLFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">is_key</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Writes common info about this flag, in XML format.</span>

<span class="sd">    This is information that is relevant to all flags (e.g., name,</span>
<span class="sd">    meaning, etc.).  If you defined a flag that has some other pieces of</span>
<span class="sd">    info, then please override _WriteCustomInfoInXMLFormat.</span>

<span class="sd">    Please do NOT override this method.</span>

<span class="sd">    Args:</span>
<span class="sd">      outfile: File object we write to.</span>
<span class="sd">      module_name: A string, the name of the module that defines this flag.</span>
<span class="sd">      is_key: A boolean, True iff this flag is key for main module.</span>
<span class="sd">      indent: A string that is prepended to each generated line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="s">&#39;&lt;flag&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">inner_indent</span> <span class="o">=</span> <span class="n">indent</span> <span class="o">+</span> <span class="s">&#39;  &#39;</span>
    <span class="k">if</span> <span class="n">is_key</span><span class="p">:</span>
      <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;key&#39;</span><span class="p">,</span> <span class="s">&#39;yes&#39;</span><span class="p">,</span> <span class="n">inner_indent</span><span class="p">)</span>
    <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;file&#39;</span><span class="p">,</span> <span class="n">module_name</span><span class="p">,</span> <span class="n">inner_indent</span><span class="p">)</span>
    <span class="c"># Print flag features that are relevant for all flags.</span>
    <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">inner_indent</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">short_name</span><span class="p">:</span>
      <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;short_name&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">short_name</span><span class="p">,</span>
                             <span class="n">inner_indent</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span><span class="p">:</span>
      <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;meaning&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span><span class="p">,</span> <span class="n">inner_indent</span><span class="p">)</span>
    <span class="c"># The default flag value can either be represented as a string like on the</span>
    <span class="c"># command line, or as a Python object.  We serialize this value in the</span>
    <span class="c"># latter case in order to remain consistent.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">serializer</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
      <span class="n">default_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">Serialize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">default_serialized</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default</span>
    <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;default&#39;</span><span class="p">,</span> <span class="n">default_serialized</span><span class="p">,</span> <span class="n">inner_indent</span><span class="p">)</span>
    <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;current&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">inner_indent</span><span class="p">)</span>
    <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;type&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span><span class="p">(),</span> <span class="n">inner_indent</span><span class="p">)</span>
    <span class="c"># Print extra flag features this flag may have.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_WriteCustomInfoInXMLFormat</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">inner_indent</span><span class="p">)</span>
    <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">indent</span> <span class="o">+</span> <span class="s">&#39;&lt;/flag&gt;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
</div>
  <span class="k">def</span> <span class="nf">_WriteCustomInfoInXMLFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Writes extra info about this flag, in XML format.</span>

<span class="sd">    &quot;Extra&quot; means &quot;not already printed by WriteInfoInXMLFormat above.&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">      outfile: File object we write to.</span>
<span class="sd">      indent: A string that is prepended to each generated line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Usually, the parser knows the extra details about the flag, so</span>
    <span class="c"># we just forward the call to it.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">WriteCustomInfoInXMLFormat</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
<span class="c"># End of Flag definition</span>

</div>
<span class="k">class</span> <span class="nc">_ArgumentParserCache</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Metaclass used to cache and share argument parsers among flags.&quot;&quot;&quot;</span>

  <span class="n">_instances</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns an instance of the argument parser cls.</span>

<span class="sd">    This method overrides behavior of the __new__ methods in</span>
<span class="sd">    all subclasses of ArgumentParser (inclusive). If an instance</span>
<span class="sd">    for mcs with the same set of arguments exists, this instance is</span>
<span class="sd">    returned, otherwise a new instance is created.</span>

<span class="sd">    If any keyword arguments are defined, or the values in args</span>
<span class="sd">    are not hashable, this method always returns a new instance of</span>
<span class="sd">    cls.</span>

<span class="sd">    Args:</span>
<span class="sd">      args: Positional initializer arguments.</span>
<span class="sd">      kwargs: Initializer keyword arguments.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An instance of cls, shared or new.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">type</span><span class="o">.</span><span class="n">__call__</span><span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">instances</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">_instances</span>
      <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">mcs</span><span class="p">,)</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">instances</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
      <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="c"># No cache entry for key exists, create a new one.</span>
        <span class="k">return</span> <span class="n">instances</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">type</span><span class="o">.</span><span class="n">__call__</span><span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">))</span>
      <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="c"># An object in args cannot be hashed, always return</span>
        <span class="c"># a new instance.</span>
        <span class="k">return</span> <span class="nb">type</span><span class="o">.</span><span class="n">__call__</span><span class="p">(</span><span class="n">mcs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>


<div class="viewcode-block" id="ArgumentParser"><a class="viewcode-back" href="../../lib.html#lib.gflags.ArgumentParser">[docs]</a><span class="k">class</span> <span class="nc">ArgumentParser</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Base class used to parse and convert arguments.</span>

<span class="sd">  The Parse() method checks to make sure that the string argument is a</span>
<span class="sd">  legal value and convert it to a native type.  If the value cannot be</span>
<span class="sd">  converted, it should throw a &#39;ValueError&#39; exception with a human</span>
<span class="sd">  readable explanation of why the value is illegal.</span>

<span class="sd">  Subclasses should also define a syntactic_help string which may be</span>
<span class="sd">  presented to the user to describe the form of the legal values.</span>

<span class="sd">  Argument parser classes must be stateless, since instances are cached</span>
<span class="sd">  and shared between flags. Initializer arguments are allowed, but all</span>
<span class="sd">  member variables must be derived from initializer arguments only.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">_ArgumentParserCache</span>

  <span class="n">syntactic_help</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

<div class="viewcode-block" id="ArgumentParser.Parse"><a class="viewcode-back" href="../../lib.html#lib.gflags.ArgumentParser.Parse">[docs]</a>  <span class="k">def</span> <span class="nf">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Default implementation: always returns its argument unmodified.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">argument</span>
</div>
<div class="viewcode-block" id="ArgumentParser.Type"><a class="viewcode-back" href="../../lib.html#lib.gflags.ArgumentParser.Type">[docs]</a>  <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;string&#39;</span>
</div>
<div class="viewcode-block" id="ArgumentParser.WriteCustomInfoInXMLFormat"><a class="viewcode-back" href="../../lib.html#lib.gflags.ArgumentParser.WriteCustomInfoInXMLFormat">[docs]</a>  <span class="k">def</span> <span class="nf">WriteCustomInfoInXMLFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="p">):</span>
    <span class="k">pass</span>

</div></div>
<div class="viewcode-block" id="ArgumentSerializer"><a class="viewcode-back" href="../../lib.html#lib.gflags.ArgumentSerializer">[docs]</a><span class="k">class</span> <span class="nc">ArgumentSerializer</span><span class="p">:</span>
  <span class="sd">&quot;&quot;&quot;Base class for generating string representations of a flag value.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="ArgumentSerializer.Serialize"><a class="viewcode-back" href="../../lib.html#lib.gflags.ArgumentSerializer.Serialize">[docs]</a>  <span class="k">def</span> <span class="nf">Serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_StrOrUnicode</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="ListSerializer"><a class="viewcode-back" href="../../lib.html#lib.gflags.ListSerializer">[docs]</a><span class="k">class</span> <span class="nc">ListSerializer</span><span class="p">(</span><span class="n">ArgumentSerializer</span><span class="p">):</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_sep</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">list_sep</span> <span class="o">=</span> <span class="n">list_sep</span>

<div class="viewcode-block" id="ListSerializer.Serialize"><a class="viewcode-back" href="../../lib.html#lib.gflags.ListSerializer.Serialize">[docs]</a>  <span class="k">def</span> <span class="nf">Serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">_StrOrUnicode</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">value</span><span class="p">])</span>


<span class="c"># Flags validators</span>

</div></div>
<div class="viewcode-block" id="RegisterValidator"><a class="viewcode-back" href="../../lib.html#lib.gflags.RegisterValidator">[docs]</a><span class="k">def</span> <span class="nf">RegisterValidator</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span>
                      <span class="n">checker</span><span class="p">,</span>
                      <span class="n">message</span><span class="o">=</span><span class="s">&#39;Flag validation failed&#39;</span><span class="p">,</span>
                      <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Adds a constraint, which will be enforced during program execution.</span>

<span class="sd">  The constraint is validated when flags are initially parsed, and after each</span>
<span class="sd">  change of the corresponding flag&#39;s value.</span>
<span class="sd">  Args:</span>
<span class="sd">    flag_name: string, name of the flag to be checked.</span>
<span class="sd">    checker: method to validate the flag.</span>
<span class="sd">      input  - value of the corresponding flag (string, boolean, etc.</span>
<span class="sd">        This value will be passed to checker by the library). See file&#39;s</span>
<span class="sd">        docstring for examples.</span>
<span class="sd">      output - Boolean.</span>
<span class="sd">        Must return True if validator constraint is satisfied.</span>
<span class="sd">        If constraint is not satisfied, it should either return False or</span>
<span class="sd">          raise gflags_validators.Error(desired_error_message).</span>
<span class="sd">    message: error text to be shown to the user if checker returns False.</span>
<span class="sd">      If checker raises gflags_validators.Error, message from the raised</span>
<span class="sd">        Error will be shown.</span>
<span class="sd">    flag_values: FlagValues</span>
<span class="sd">  Raises:</span>
<span class="sd">    AttributeError: if flag_name is not registered as a valid flag name.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">flag_values</span><span class="o">.</span><span class="n">AddValidator</span><span class="p">(</span><span class="n">gflags_validators</span><span class="o">.</span><span class="n">SimpleValidator</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span>
                                                            <span class="n">checker</span><span class="p">,</span>
                                                            <span class="n">message</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="MarkFlagAsRequired"><a class="viewcode-back" href="../../lib.html#lib.gflags.MarkFlagAsRequired">[docs]</a><span class="k">def</span> <span class="nf">MarkFlagAsRequired</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Ensure that flag is not None during program execution.</span>

<span class="sd">  Registers a flag validator, which will follow usual validator</span>
<span class="sd">  rules.</span>
<span class="sd">  Args:</span>
<span class="sd">    flag_name: string, name of the flag</span>
<span class="sd">    flag_values: FlagValues</span>
<span class="sd">  Raises:</span>
<span class="sd">    AttributeError: if flag_name is not registered as a valid flag name.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">RegisterValidator</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span>
                    <span class="k">lambda</span> <span class="n">value</span><span class="p">:</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">message</span><span class="o">=</span><span class="s">&#39;Flag --</span><span class="si">%s</span><span class="s"> must be specified.&#39;</span> <span class="o">%</span> <span class="n">flag_name</span><span class="p">,</span>
                    <span class="n">flag_values</span><span class="o">=</span><span class="n">flag_values</span><span class="p">)</span>

</div>
<span class="k">def</span> <span class="nf">_RegisterBoundsValidatorIfNeeded</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Enforce lower and upper bounds for numeric flags.</span>

<span class="sd">  Args:</span>
<span class="sd">    parser: NumericParser (either FloatParser or IntegerParser). Provides lower</span>
<span class="sd">      and upper bounds, and help text to display.</span>
<span class="sd">    name: string, name of the flag</span>
<span class="sd">    flag_values: FlagValues</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">parser</span><span class="o">.</span><span class="n">lower_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">parser</span><span class="o">.</span><span class="n">upper_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">Checker</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">parser</span><span class="o">.</span><span class="n">IsOutsideBounds</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> is not </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">parser</span><span class="o">.</span><span class="n">syntactic_help</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">gflags_validators</span><span class="o">.</span><span class="n">Error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
      <span class="k">return</span> <span class="bp">True</span>

    <span class="n">RegisterValidator</span><span class="p">(</span><span class="n">name</span><span class="p">,</span>
                      <span class="n">Checker</span><span class="p">,</span>
                      <span class="n">flag_values</span><span class="o">=</span><span class="n">flag_values</span><span class="p">)</span>


<span class="c"># The DEFINE functions are explained in mode details in the module doc string.</span>


<div class="viewcode-block" id="DEFINE"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE">[docs]</a><span class="k">def</span> <span class="nf">DEFINE</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="n">serializer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
           <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a generic Flag object.</span>

<span class="sd">  NOTE: in the docstrings of all DEFINE* functions, &quot;registers&quot; is short</span>
<span class="sd">  for &quot;creates a new flag and registers it&quot;.</span>

<span class="sd">  Auxiliary function: clients should use the specialized DEFINE_&lt;type&gt;</span>
<span class="sd">  function instead.</span>

<span class="sd">  Args:</span>
<span class="sd">    parser: ArgumentParser that is used to parse the flag arguments.</span>
<span class="sd">    name: A string, the flag name.</span>
<span class="sd">    default: The default value of the flag.</span>
<span class="sd">    help: A help string.</span>
<span class="sd">    flag_values: FlagValues object the flag will be registered with.</span>
<span class="sd">    serializer: ArgumentSerializer that serializes the flag value.</span>
<span class="sd">    args: Dictionary with extra keyword args that are passes to the</span>
<span class="sd">      Flag __init__.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">DEFINE_flag</span><span class="p">(</span><span class="n">Flag</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">),</span>
              <span class="n">flag_values</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="DEFINE_flag"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_flag">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_flag</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a &#39;Flag&#39; object with a &#39;FlagValues&#39; object.</span>

<span class="sd">  By default, the global FLAGS &#39;FlagValue&#39; object is used.</span>

<span class="sd">  Typical users will use one of the more specialized DEFINE_xxx</span>
<span class="sd">  functions, such as DEFINE_string or DEFINE_integer.  But developers</span>
<span class="sd">  who need to create Flag objects themselves should use this function</span>
<span class="sd">  to register their flags.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c"># copying the reference to flag_values prevents pychecker warnings</span>
  <span class="n">fv</span> <span class="o">=</span> <span class="n">flag_values</span>
  <span class="n">fv</span><span class="p">[</span><span class="n">flag</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
  <span class="c"># Tell flag_values who&#39;s defining the flag.</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flag_values</span><span class="p">,</span> <span class="n">FlagValues</span><span class="p">):</span>
    <span class="c"># Regarding the above isinstance test: some users pass funny</span>
    <span class="c"># values of flag_values (e.g., {}) in order to avoid the flag</span>
    <span class="c"># registration (in the past, there used to be a flag_values ==</span>
    <span class="c"># FLAGS test here) and redefine flags with the same name (e.g.,</span>
    <span class="c"># debug).  To avoid breaking their code, we perform the</span>
    <span class="c"># registration only if flag_values is a real FlagValues object.</span>
    <span class="n">module</span><span class="p">,</span> <span class="n">module_name</span> <span class="o">=</span> <span class="n">_GetCallingModuleObjectAndName</span><span class="p">()</span>
    <span class="n">flag_values</span><span class="o">.</span><span class="n">_RegisterFlagByModule</span><span class="p">(</span><span class="n">module_name</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>
    <span class="n">flag_values</span><span class="o">.</span><span class="n">_RegisterFlagByModuleId</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="n">module</span><span class="p">),</span> <span class="n">flag</span><span class="p">)</span>

</div>
<span class="k">def</span> <span class="nf">_InternalDeclareKeyFlags</span><span class="p">(</span><span class="n">flag_names</span><span class="p">,</span>
                             <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="n">key_flag_values</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Declares a flag as key for the calling module.</span>

<span class="sd">  Internal function.  User code should call DECLARE_key_flag or</span>
<span class="sd">  ADOPT_module_key_flags instead.</span>

<span class="sd">  Args:</span>
<span class="sd">    flag_names: A list of strings that are names of already-registered</span>
<span class="sd">      Flag objects.</span>
<span class="sd">    flag_values: A FlagValues object that the flags listed in</span>
<span class="sd">      flag_names have registered with (the value of the flag_values</span>
<span class="sd">      argument from the DEFINE_* calls that defined those flags).</span>
<span class="sd">      This should almost never need to be overridden.</span>
<span class="sd">    key_flag_values: A FlagValues object that (among possibly many</span>
<span class="sd">      other things) keeps track of the key flags for each module.</span>
<span class="sd">      Default None means &quot;same as flag_values&quot;.  This should almost</span>
<span class="sd">      never need to be overridden.</span>

<span class="sd">  Raises:</span>
<span class="sd">    UnrecognizedFlagError: when we refer to a flag that was not</span>
<span class="sd">      defined yet.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">key_flag_values</span> <span class="o">=</span> <span class="n">key_flag_values</span> <span class="ow">or</span> <span class="n">flag_values</span>

  <span class="n">module</span> <span class="o">=</span> <span class="n">_GetCallingModule</span><span class="p">()</span>

  <span class="k">for</span> <span class="n">flag_name</span> <span class="ow">in</span> <span class="n">flag_names</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">flag_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">flag_values</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">UnrecognizedFlagError</span><span class="p">(</span><span class="n">flag_name</span><span class="p">)</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">flag_values</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()[</span><span class="n">flag_name</span><span class="p">]</span>
    <span class="n">key_flag_values</span><span class="o">.</span><span class="n">_RegisterKeyFlagForModule</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>


<div class="viewcode-block" id="DECLARE_key_flag"><a class="viewcode-back" href="../../lib.html#lib.gflags.DECLARE_key_flag">[docs]</a><span class="k">def</span> <span class="nf">DECLARE_key_flag</span><span class="p">(</span><span class="n">flag_name</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Declares one flag as key to the current module.</span>

<span class="sd">  Key flags are flags that are deemed really important for a module.</span>
<span class="sd">  They are important when listing help messages; e.g., if the</span>
<span class="sd">  --helpshort command-line flag is used, then only the key flags of the</span>
<span class="sd">  main module are listed (instead of all flags, as in the case of</span>
<span class="sd">  --help).</span>

<span class="sd">  Sample usage:</span>

<span class="sd">    gflags.DECLARED_key_flag(&#39;flag_1&#39;)</span>

<span class="sd">  Args:</span>
<span class="sd">    flag_name: A string, the name of an already declared flag.</span>
<span class="sd">      (Redeclaring flags as key, including flags implicitly key</span>
<span class="sd">      because they were declared in this module, is a no-op.)</span>
<span class="sd">    flag_values: A FlagValues object.  This should almost never</span>
<span class="sd">      need to be overridden.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">flag_name</span> <span class="ow">in</span> <span class="n">_SPECIAL_FLAGS</span><span class="p">:</span>
    <span class="c"># Take care of the special flags, e.g., --flagfile, --undefok.</span>
    <span class="c"># These flags are defined in _SPECIAL_FLAGS, and are treated</span>
    <span class="c"># specially during flag parsing, taking precedence over the</span>
    <span class="c"># user-defined flags.</span>
    <span class="n">_InternalDeclareKeyFlags</span><span class="p">([</span><span class="n">flag_name</span><span class="p">],</span>
                             <span class="n">flag_values</span><span class="o">=</span><span class="n">_SPECIAL_FLAGS</span><span class="p">,</span>
                             <span class="n">key_flag_values</span><span class="o">=</span><span class="n">flag_values</span><span class="p">)</span>
    <span class="k">return</span>
  <span class="n">_InternalDeclareKeyFlags</span><span class="p">([</span><span class="n">flag_name</span><span class="p">],</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">flag_values</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="ADOPT_module_key_flags"><a class="viewcode-back" href="../../lib.html#lib.gflags.ADOPT_module_key_flags">[docs]</a><span class="k">def</span> <span class="nf">ADOPT_module_key_flags</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Declares that all flags key to a module are key to the current module.</span>

<span class="sd">  Args:</span>
<span class="sd">    module: A module object.</span>
<span class="sd">    flag_values: A FlagValues object.  This should almost never need</span>
<span class="sd">      to be overridden.</span>

<span class="sd">  Raises:</span>
<span class="sd">    FlagsError: When given an argument that is a module name (a</span>
<span class="sd">    string), instead of a module object.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="c"># NOTE(salcianu): an even better test would be if not</span>
  <span class="c"># isinstance(module, types.ModuleType) but I didn&#39;t want to import</span>
  <span class="c"># types for such a tiny use.</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">module</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">FlagsError</span><span class="p">(</span><span class="s">&#39;Received module name </span><span class="si">%s</span><span class="s">; expected a module object.&#39;</span>
                     <span class="o">%</span> <span class="n">module</span><span class="p">)</span>
  <span class="n">_InternalDeclareKeyFlags</span><span class="p">(</span>
      <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">flag_values</span><span class="o">.</span><span class="n">_GetKeyFlagsForModule</span><span class="p">(</span><span class="n">module</span><span class="o">.</span><span class="n">__name__</span><span class="p">)],</span>
      <span class="n">flag_values</span><span class="o">=</span><span class="n">flag_values</span><span class="p">)</span>
  <span class="c"># If module is this flag module, take _SPECIAL_FLAGS into account.</span>
  <span class="k">if</span> <span class="n">module</span> <span class="o">==</span> <span class="n">_GetThisModuleObjectAndName</span><span class="p">()[</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">_InternalDeclareKeyFlags</span><span class="p">(</span>
        <span class="c"># As we associate flags with _GetCallingModuleObjectAndName(), the</span>
        <span class="c"># special flags defined in this module are incorrectly registered with</span>
        <span class="c"># a different module.  So, we can&#39;t use _GetKeyFlagsForModule.</span>
        <span class="c"># Instead, we take all flags from _SPECIAL_FLAGS (a private</span>
        <span class="c"># FlagValues, where no other module should register flags).</span>
        <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">_SPECIAL_FLAGS</span><span class="o">.</span><span class="n">FlagDict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
        <span class="n">flag_values</span><span class="o">=</span><span class="n">_SPECIAL_FLAGS</span><span class="p">,</span>
        <span class="n">key_flag_values</span><span class="o">=</span><span class="n">flag_values</span><span class="p">)</span>


<span class="c">#</span>
<span class="c"># STRING FLAGS</span>
<span class="c">#</span>

</div>
<div class="viewcode-block" id="DEFINE_string"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_string">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a flag whose value can be any string.&quot;&quot;&quot;</span>
  <span class="n">parser</span> <span class="o">=</span> <span class="n">ArgumentParser</span><span class="p">()</span>
  <span class="n">serializer</span> <span class="o">=</span> <span class="n">ArgumentSerializer</span><span class="p">()</span>
  <span class="n">DEFINE</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>


<span class="c">#</span>
<span class="c"># BOOLEAN FLAGS</span>
<span class="c">#</span>

</div>
<div class="viewcode-block" id="BooleanParser"><a class="viewcode-back" href="../../lib.html#lib.gflags.BooleanParser">[docs]</a><span class="k">class</span> <span class="nc">BooleanParser</span><span class="p">(</span><span class="n">ArgumentParser</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Parser of boolean values.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="BooleanParser.Convert"><a class="viewcode-back" href="../../lib.html#lib.gflags.BooleanParser.Convert">[docs]</a>  <span class="k">def</span> <span class="nf">Convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts the argument to a boolean; raise ValueError on errors.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">argument</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;true&#39;</span><span class="p">,</span> <span class="s">&#39;t&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">True</span>
      <span class="k">elif</span> <span class="n">argument</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;false&#39;</span><span class="p">,</span> <span class="s">&#39;f&#39;</span><span class="p">,</span> <span class="s">&#39;0&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="n">bool_argument</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">argument</span> <span class="o">==</span> <span class="n">bool_argument</span><span class="p">:</span>
      <span class="c"># The argument is a valid boolean (True, False, 0, or 1), and not just</span>
      <span class="c"># something that always converts to bool (list, string, int, etc.).</span>
      <span class="k">return</span> <span class="n">bool_argument</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Non-boolean argument to boolean flag&#39;</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="BooleanParser.Parse"><a class="viewcode-back" href="../../lib.html#lib.gflags.BooleanParser.Parse">[docs]</a>  <span class="k">def</span> <span class="nf">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
    <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Convert</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">val</span>
</div>
<div class="viewcode-block" id="BooleanParser.Type"><a class="viewcode-back" href="../../lib.html#lib.gflags.BooleanParser.Type">[docs]</a>  <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;bool&#39;</span>

</div></div>
<div class="viewcode-block" id="BooleanFlag"><a class="viewcode-back" href="../../lib.html#lib.gflags.BooleanFlag">[docs]</a><span class="k">class</span> <span class="nc">BooleanFlag</span><span class="p">(</span><span class="n">Flag</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Basic boolean flag.</span>

<span class="sd">  Boolean flags do not take any arguments, and their value is either</span>
<span class="sd">  True (1) or False (0).  The false value is specified on the command</span>
<span class="sd">  line by prepending the word &#39;no&#39; to either the long or the short flag</span>
<span class="sd">  name.</span>

<span class="sd">  For example, if a Boolean flag was created whose long name was</span>
<span class="sd">  &#39;update&#39; and whose short name was &#39;x&#39;, then this flag could be</span>
<span class="sd">  explicitly unset through either --noupdate or --nox.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">short_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">BooleanParser</span><span class="p">()</span>
    <span class="n">Flag</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">short_name</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span> <span class="o">=</span> <span class="s">&quot;a boolean value&quot;</span>

</div>
<div class="viewcode-block" id="DEFINE_boolean"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_boolean">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_boolean</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a boolean flag.</span>

<span class="sd">  Such a boolean flag does not take an argument.  If a user wants to</span>
<span class="sd">  specify a false value explicitly, the long option beginning with &#39;no&#39;</span>
<span class="sd">  must be used: i.e. --noflag</span>

<span class="sd">  This flag will have a value of None, True or False.  None is possible</span>
<span class="sd">  if default=None and the user does not specify the flag on the command</span>
<span class="sd">  line.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">DEFINE_flag</span><span class="p">(</span><span class="n">BooleanFlag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">),</span> <span class="n">flag_values</span><span class="p">)</span>


<span class="c"># Match C++ API to unconfuse C++ people.</span></div>
<span class="n">DEFINE_bool</span> <span class="o">=</span> <span class="n">DEFINE_boolean</span>


<div class="viewcode-block" id="HelpFlag"><a class="viewcode-back" href="../../lib.html#lib.gflags.HelpFlag">[docs]</a><span class="k">class</span> <span class="nc">HelpFlag</span><span class="p">(</span><span class="n">BooleanFlag</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  HelpFlag is a special boolean flag that prints usage information and</span>
<span class="sd">  raises a SystemExit exception if it is ever found in the command</span>
<span class="sd">  line arguments.  Note this is called with allow_override=1, so other</span>
<span class="sd">  apps can define their own --help flag, replacing this one, if they want.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">BooleanFlag</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;help&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;show this help&quot;</span><span class="p">,</span>
                         <span class="n">short_name</span><span class="o">=</span><span class="s">&quot;?&quot;</span><span class="p">,</span> <span class="n">allow_override</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<div class="viewcode-block" id="HelpFlag.Parse"><a class="viewcode-back" href="../../lib.html#lib.gflags.HelpFlag.Parse">[docs]</a>  <span class="k">def</span> <span class="nf">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">arg</span><span class="p">:</span>
      <span class="n">doc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&quot;__main__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">__doc__</span>
      <span class="n">flags</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">FLAGS</span><span class="p">)</span>
      <span class="k">print</span> <span class="n">doc</span> <span class="ow">or</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">USAGE: </span><span class="si">%s</span><span class="s"> [flags]</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="k">if</span> <span class="n">flags</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;flags:&quot;</span>
        <span class="k">print</span> <span class="n">flags</span>
      <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div></div>
<div class="viewcode-block" id="HelpXMLFlag"><a class="viewcode-back" href="../../lib.html#lib.gflags.HelpXMLFlag">[docs]</a><span class="k">class</span> <span class="nc">HelpXMLFlag</span><span class="p">(</span><span class="n">BooleanFlag</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Similar to HelpFlag, but generates output in XML format.&quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">BooleanFlag</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;helpxml&#39;</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span>
                         <span class="s">&#39;like --help, but generates XML output&#39;</span><span class="p">,</span>
                         <span class="n">allow_override</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<div class="viewcode-block" id="HelpXMLFlag.Parse"><a class="viewcode-back" href="../../lib.html#lib.gflags.HelpXMLFlag.Parse">[docs]</a>  <span class="k">def</span> <span class="nf">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">arg</span><span class="p">:</span>
      <span class="n">FLAGS</span><span class="o">.</span><span class="n">WriteHelpInXMLFormat</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
      <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></div></div>
<div class="viewcode-block" id="HelpshortFlag"><a class="viewcode-back" href="../../lib.html#lib.gflags.HelpshortFlag">[docs]</a><span class="k">class</span> <span class="nc">HelpshortFlag</span><span class="p">(</span><span class="n">BooleanFlag</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  HelpshortFlag is a special boolean flag that prints usage</span>
<span class="sd">  information for the &quot;main&quot; module, and rasies a SystemExit exception</span>
<span class="sd">  if it is ever found in the command line arguments.  Note this is</span>
<span class="sd">  called with allow_override=1, so other apps can define their own</span>
<span class="sd">  --helpshort flag, replacing this one, if they want.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">BooleanFlag</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&quot;helpshort&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                         <span class="s">&quot;show usage only for this module&quot;</span><span class="p">,</span> <span class="n">allow_override</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<div class="viewcode-block" id="HelpshortFlag.Parse"><a class="viewcode-back" href="../../lib.html#lib.gflags.HelpshortFlag.Parse">[docs]</a>  <span class="k">def</span> <span class="nf">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">arg</span><span class="p">:</span>
      <span class="n">doc</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s">&quot;__main__&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">__doc__</span>
      <span class="n">flags</span> <span class="o">=</span> <span class="n">FLAGS</span><span class="o">.</span><span class="n">MainModuleHelp</span><span class="p">()</span>
      <span class="k">print</span> <span class="n">doc</span> <span class="ow">or</span> <span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">USAGE: </span><span class="si">%s</span><span class="s"> [flags]</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
      <span class="k">if</span> <span class="n">flags</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;flags:&quot;</span>
        <span class="k">print</span> <span class="n">flags</span>
      <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c">#</span>
<span class="c"># Numeric parser - base class for Integer and Float parsers</span>
<span class="c">#</span>

</div></div>
<div class="viewcode-block" id="NumericParser"><a class="viewcode-back" href="../../lib.html#lib.gflags.NumericParser">[docs]</a><span class="k">class</span> <span class="nc">NumericParser</span><span class="p">(</span><span class="n">ArgumentParser</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Parser of numeric values.</span>

<span class="sd">  Parsed value may be bounded to a given upper and lower bound.</span>
<span class="sd">  &quot;&quot;&quot;</span>

<div class="viewcode-block" id="NumericParser.IsOutsideBounds"><a class="viewcode-back" href="../../lib.html#lib.gflags.NumericParser.IsOutsideBounds">[docs]</a>  <span class="k">def</span> <span class="nf">IsOutsideBounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">)</span> <span class="ow">or</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="NumericParser.Parse"><a class="viewcode-back" href="../../lib.html#lib.gflags.NumericParser.Parse">[docs]</a>  <span class="k">def</span> <span class="nf">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
    <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Convert</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IsOutsideBounds</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> is not </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">syntactic_help</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">val</span>
</div>
<div class="viewcode-block" id="NumericParser.WriteCustomInfoInXMLFormat"><a class="viewcode-back" href="../../lib.html#lib.gflags.NumericParser.WriteCustomInfoInXMLFormat">[docs]</a>  <span class="k">def</span> <span class="nf">WriteCustomInfoInXMLFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;lower_bound&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;upper_bound&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="NumericParser.Convert"><a class="viewcode-back" href="../../lib.html#lib.gflags.NumericParser.Convert">[docs]</a>  <span class="k">def</span> <span class="nf">Convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Default implementation: always returns its argument unmodified.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">argument</span>

<span class="c"># End of Numeric Parser</span>

<span class="c">#</span>
<span class="c"># FLOAT FLAGS</span>
<span class="c">#</span>

</div></div>
<div class="viewcode-block" id="FloatParser"><a class="viewcode-back" href="../../lib.html#lib.gflags.FloatParser">[docs]</a><span class="k">class</span> <span class="nc">FloatParser</span><span class="p">(</span><span class="n">NumericParser</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Parser of floating point values.</span>

<span class="sd">  Parsed value may be bounded to a given upper and lower bound.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">number_article</span> <span class="o">=</span> <span class="s">&quot;a&quot;</span>
  <span class="n">number_name</span> <span class="o">=</span> <span class="s">&quot;number&quot;</span>
  <span class="n">syntactic_help</span> <span class="o">=</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">number_article</span><span class="p">,</span> <span class="n">number_name</span><span class="p">))</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">FloatParser</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">=</span> <span class="n">lower_bound</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upper_bound</span> <span class="o">=</span> <span class="n">upper_bound</span>
    <span class="n">sh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">syntactic_help</span>
    <span class="k">if</span> <span class="n">lower_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> in the range [</span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sh</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">lower_bound</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;a non-negative </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_name</span>
    <span class="k">elif</span> <span class="n">upper_bound</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;a non-positive </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_name</span>
    <span class="k">elif</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> &lt;= </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_name</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">lower_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> &gt;= </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_name</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">syntactic_help</span> <span class="o">=</span> <span class="n">sh</span>

<div class="viewcode-block" id="FloatParser.Convert"><a class="viewcode-back" href="../../lib.html#lib.gflags.FloatParser.Convert">[docs]</a>  <span class="k">def</span> <span class="nf">Convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts argument to a float; raises ValueError on errors.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="FloatParser.Type"><a class="viewcode-back" href="../../lib.html#lib.gflags.FloatParser.Type">[docs]</a>  <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;float&#39;</span>
<span class="c"># End of FloatParser</span>

</div></div>
<div class="viewcode-block" id="DEFINE_float"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_float">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_float</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a flag whose value must be a float.</span>

<span class="sd">  If lower_bound or upper_bound are set, then this flag must be</span>
<span class="sd">  within the given range.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">parser</span> <span class="o">=</span> <span class="n">FloatParser</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
  <span class="n">serializer</span> <span class="o">=</span> <span class="n">ArgumentSerializer</span><span class="p">()</span>
  <span class="n">DEFINE</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
  <span class="n">_RegisterBoundsValidatorIfNeeded</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">flag_values</span><span class="p">)</span>

<span class="c">#</span>
<span class="c"># INTEGER FLAGS</span>
<span class="c">#</span>

</div>
<div class="viewcode-block" id="IntegerParser"><a class="viewcode-back" href="../../lib.html#lib.gflags.IntegerParser">[docs]</a><span class="k">class</span> <span class="nc">IntegerParser</span><span class="p">(</span><span class="n">NumericParser</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Parser of an integer value.</span>

<span class="sd">  Parsed value may be bounded to a given upper and lower bound.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">number_article</span> <span class="o">=</span> <span class="s">&quot;an&quot;</span>
  <span class="n">number_name</span> <span class="o">=</span> <span class="s">&quot;integer&quot;</span>
  <span class="n">syntactic_help</span> <span class="o">=</span> <span class="s">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">number_article</span><span class="p">,</span> <span class="n">number_name</span><span class="p">))</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">IntegerParser</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lower_bound</span> <span class="o">=</span> <span class="n">lower_bound</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upper_bound</span> <span class="o">=</span> <span class="n">upper_bound</span>
    <span class="n">sh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">syntactic_help</span>
    <span class="k">if</span> <span class="n">lower_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> in the range [</span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sh</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">lower_bound</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;a positive </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_name</span>
    <span class="k">elif</span> <span class="n">upper_bound</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;a negative </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_name</span>
    <span class="k">elif</span> <span class="n">lower_bound</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;a non-negative </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_name</span>
    <span class="k">elif</span> <span class="n">upper_bound</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;a non-positive </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_name</span>
    <span class="k">elif</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> &lt;= </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_name</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">lower_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">sh</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s"> &gt;= </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_name</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">syntactic_help</span> <span class="o">=</span> <span class="n">sh</span>

<div class="viewcode-block" id="IntegerParser.Convert"><a class="viewcode-back" href="../../lib.html#lib.gflags.IntegerParser.Convert">[docs]</a>  <span class="k">def</span> <span class="nf">Convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
    <span class="n">__pychecker__</span> <span class="o">=</span> <span class="s">&#39;no-returnvalues&#39;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
      <span class="n">base</span> <span class="o">=</span> <span class="mi">10</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">argument</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;0&quot;</span> <span class="ow">and</span> <span class="n">argument</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s">&quot;x&quot;</span><span class="p">:</span>
        <span class="n">base</span> <span class="o">=</span> <span class="mi">16</span>
      <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="IntegerParser.Type"><a class="viewcode-back" href="../../lib.html#lib.gflags.IntegerParser.Type">[docs]</a>  <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;int&#39;</span>

</div></div>
<div class="viewcode-block" id="DEFINE_integer"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_integer">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_integer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                   <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a flag whose value must be an integer.</span>

<span class="sd">  If lower_bound, or upper_bound are set, then this flag must be</span>
<span class="sd">  within the given range.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">parser</span> <span class="o">=</span> <span class="n">IntegerParser</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
  <span class="n">serializer</span> <span class="o">=</span> <span class="n">ArgumentSerializer</span><span class="p">()</span>
  <span class="n">DEFINE</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
  <span class="n">_RegisterBoundsValidatorIfNeeded</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">flag_values</span><span class="p">)</span>


<span class="c">#</span>
<span class="c"># ENUM FLAGS</span>
<span class="c">#</span>

</div>
<div class="viewcode-block" id="EnumParser"><a class="viewcode-back" href="../../lib.html#lib.gflags.EnumParser">[docs]</a><span class="k">class</span> <span class="nc">EnumParser</span><span class="p">(</span><span class="n">ArgumentParser</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Parser of a string enum value (a string value from a given set).</span>

<span class="sd">  If enum_values (see below) is not specified, any string is allowed.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enum_values</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">EnumParser</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">enum_values</span> <span class="o">=</span> <span class="n">enum_values</span>

<div class="viewcode-block" id="EnumParser.Parse"><a class="viewcode-back" href="../../lib.html#lib.gflags.EnumParser.Parse">[docs]</a>  <span class="k">def</span> <span class="nf">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">enum_values</span> <span class="ow">and</span> <span class="n">argument</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">enum_values</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;value should be one of &lt;</span><span class="si">%s</span><span class="s">&gt;&quot;</span> <span class="o">%</span>
                       <span class="s">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">enum_values</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">argument</span>
</div>
<div class="viewcode-block" id="EnumParser.Type"><a class="viewcode-back" href="../../lib.html#lib.gflags.EnumParser.Type">[docs]</a>  <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;string enum&#39;</span>

</div></div>
<div class="viewcode-block" id="EnumFlag"><a class="viewcode-back" href="../../lib.html#lib.gflags.EnumFlag">[docs]</a><span class="k">class</span> <span class="nc">EnumFlag</span><span class="p">(</span><span class="n">Flag</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Basic enum flag; its value can be any string from list of enum_values.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">enum_values</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">short_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="n">enum_values</span> <span class="o">=</span> <span class="n">enum_values</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">EnumParser</span><span class="p">(</span><span class="n">enum_values</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">ArgumentSerializer</span><span class="p">()</span>
    <span class="n">Flag</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">short_name</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span> <span class="o">=</span> <span class="s">&quot;an enum string&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">help</span> <span class="o">=</span> <span class="s">&quot;&lt;</span><span class="si">%s</span><span class="s">&gt;: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">enum_values</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">help</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_WriteCustomInfoInXMLFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">enum_value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">enum_values</span><span class="p">:</span>
      <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;enum_value&#39;</span><span class="p">,</span> <span class="n">enum_value</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="DEFINE_enum"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_enum">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_enum</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">enum_values</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span>
                <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a flag whose value can be any string from enum_values.&quot;&quot;&quot;</span>
  <span class="n">DEFINE_flag</span><span class="p">(</span><span class="n">EnumFlag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">enum_values</span><span class="p">,</span> <span class="o">**</span> <span class="n">args</span><span class="p">),</span>
              <span class="n">flag_values</span><span class="p">)</span>


<span class="c">#</span>
<span class="c"># LIST FLAGS</span>
<span class="c">#</span>

</div>
<div class="viewcode-block" id="BaseListParser"><a class="viewcode-back" href="../../lib.html#lib.gflags.BaseListParser">[docs]</a><span class="k">class</span> <span class="nc">BaseListParser</span><span class="p">(</span><span class="n">ArgumentParser</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Base class for a parser of lists of strings.</span>

<span class="sd">  To extend, inherit from this class; from the subclass __init__, call</span>

<span class="sd">    BaseListParser.__init__(self, token, name)</span>

<span class="sd">  where token is a character used to tokenize, and name is a description</span>
<span class="sd">  of the separator.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">name</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">BaseListParser</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_token</span> <span class="o">=</span> <span class="n">token</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">syntactic_help</span> <span class="o">=</span> <span class="s">&quot;a </span><span class="si">%s</span><span class="s"> separated list&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

<div class="viewcode-block" id="BaseListParser.Parse"><a class="viewcode-back" href="../../lib.html#lib.gflags.BaseListParser.Parse">[docs]</a>  <span class="k">def</span> <span class="nf">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
      <span class="k">return</span> <span class="n">argument</span>
    <span class="k">elif</span> <span class="n">argument</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
      <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">argument</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_token</span><span class="p">)]</span>
</div>
<div class="viewcode-block" id="BaseListParser.Type"><a class="viewcode-back" href="../../lib.html#lib.gflags.BaseListParser.Type">[docs]</a>  <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s"> separated list of strings&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>

</div></div>
<div class="viewcode-block" id="ListParser"><a class="viewcode-back" href="../../lib.html#lib.gflags.ListParser">[docs]</a><span class="k">class</span> <span class="nc">ListParser</span><span class="p">(</span><span class="n">BaseListParser</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Parser for a comma-separated list of strings.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">BaseListParser</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s">&#39;,&#39;</span><span class="p">,</span> <span class="s">&#39;comma&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="ListParser.WriteCustomInfoInXMLFormat"><a class="viewcode-back" href="../../lib.html#lib.gflags.ListParser.WriteCustomInfoInXMLFormat">[docs]</a>  <span class="k">def</span> <span class="nf">WriteCustomInfoInXMLFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="p">):</span>
    <span class="n">BaseListParser</span><span class="o">.</span><span class="n">WriteCustomInfoInXMLFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
    <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;list_separator&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">),</span> <span class="n">indent</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="WhitespaceSeparatedListParser"><a class="viewcode-back" href="../../lib.html#lib.gflags.WhitespaceSeparatedListParser">[docs]</a><span class="k">class</span> <span class="nc">WhitespaceSeparatedListParser</span><span class="p">(</span><span class="n">BaseListParser</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Parser for a whitespace-separated list of strings.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">BaseListParser</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="s">&#39;whitespace&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="WhitespaceSeparatedListParser.WriteCustomInfoInXMLFormat"><a class="viewcode-back" href="../../lib.html#lib.gflags.WhitespaceSeparatedListParser.WriteCustomInfoInXMLFormat">[docs]</a>  <span class="k">def</span> <span class="nf">WriteCustomInfoInXMLFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="p">):</span>
    <span class="n">BaseListParser</span><span class="o">.</span><span class="n">WriteCustomInfoInXMLFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">indent</span><span class="p">)</span>
    <span class="n">separators</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">whitespace</span><span class="p">)</span>
    <span class="n">separators</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ws_char</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">whitespace</span><span class="p">:</span>
      <span class="n">_WriteSimpleXMLElement</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s">&#39;list_separator&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">ws_char</span><span class="p">),</span> <span class="n">indent</span><span class="p">)</span>

</div></div>
<div class="viewcode-block" id="DEFINE_list"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_list">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_list</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a flag whose value is a comma-separated list of strings.&quot;&quot;&quot;</span>
  <span class="n">parser</span> <span class="o">=</span> <span class="n">ListParser</span><span class="p">()</span>
  <span class="n">serializer</span> <span class="o">=</span> <span class="n">ListSerializer</span><span class="p">(</span><span class="s">&#39;,&#39;</span><span class="p">)</span>
  <span class="n">DEFINE</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="DEFINE_spaceseplist"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_spaceseplist">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_spaceseplist</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a flag whose value is a whitespace-separated list of strings.</span>

<span class="sd">  Any whitespace can be used as a separator.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">parser</span> <span class="o">=</span> <span class="n">WhitespaceSeparatedListParser</span><span class="p">()</span>
  <span class="n">serializer</span> <span class="o">=</span> <span class="n">ListSerializer</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>
  <span class="n">DEFINE</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>


<span class="c">#</span>
<span class="c"># MULTI FLAGS</span>
<span class="c">#</span>

</div>
<div class="viewcode-block" id="MultiFlag"><a class="viewcode-back" href="../../lib.html#lib.gflags.MultiFlag">[docs]</a><span class="k">class</span> <span class="nc">MultiFlag</span><span class="p">(</span><span class="n">Flag</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A flag that can appear multiple time on the command-line.</span>

<span class="sd">  The value of such a flag is a list that contains the individual values</span>
<span class="sd">  from all the appearances of that flag on the command-line.</span>

<span class="sd">  See the __doc__ for Flag for most behavior of this class.  Only</span>
<span class="sd">  differences in behavior are described here:</span>

<span class="sd">    * The default value may be either a single value or a list of values.</span>
<span class="sd">      A single value is interpreted as the [value] singleton list.</span>

<span class="sd">    * The value of the flag is always a list, even if the option was</span>
<span class="sd">      only supplied once, and even if the default value is a single</span>
<span class="sd">      value</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">Flag</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">help</span> <span class="o">+=</span> <span class="s">&#39;;</span><span class="se">\n</span><span class="s">    repeat this option to specify a list of values&#39;</span>

<div class="viewcode-block" id="MultiFlag.Parse"><a class="viewcode-back" href="../../lib.html#lib.gflags.MultiFlag.Parse">[docs]</a>  <span class="k">def</span> <span class="nf">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Parses one or more arguments with the installed parser.</span>

<span class="sd">    Args:</span>
<span class="sd">      arguments: a single argument or a list of arguments (typically a</span>
<span class="sd">        list of default values); a single argument is converted</span>
<span class="sd">        internally into a list containing one item.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
      <span class="c"># Default value may be a list of values.  Most other arguments</span>
      <span class="c"># will not be, so convert them into a single-item list to make</span>
      <span class="c"># processing simpler below.</span>
      <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">arguments</span><span class="p">]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">present</span><span class="p">:</span>
      <span class="c"># keep a backup reference to list of previously supplied option values</span>
      <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="c"># &quot;erase&quot; the defaults with an empty list</span>
      <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
      <span class="c"># have Flag superclass parse argument, overwriting self.value reference</span>
      <span class="n">Flag</span><span class="o">.</span><span class="n">Parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>  <span class="c"># also increments self.present</span>
      <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="c"># put list of option values back in the &#39;value&#39; attribute</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">values</span>
</div>
<div class="viewcode-block" id="MultiFlag.Serialize"><a class="viewcode-back" href="../../lib.html#lib.gflags.MultiFlag.Serialize">[docs]</a>  <span class="k">def</span> <span class="nf">Serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">serializer</span><span class="p">:</span>
      <span class="k">raise</span> <span class="n">FlagsError</span><span class="p">(</span><span class="s">&quot;Serializer not present for flag </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="k">return</span> <span class="s">&#39;&#39;</span>

    <span class="n">s</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

    <span class="n">multi_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>

    <span class="k">for</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">in</span> <span class="n">multi_value</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span> <span class="o">+=</span> <span class="s">&#39; &#39;</span>
      <span class="n">s</span> <span class="o">+=</span> <span class="n">Flag</span><span class="o">.</span><span class="n">Serialize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">multi_value</span>

    <span class="k">return</span> <span class="n">s</span>
</div>
<div class="viewcode-block" id="MultiFlag.Type"><a class="viewcode-back" href="../../lib.html#lib.gflags.MultiFlag.Type">[docs]</a>  <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;multi &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">Type</span><span class="p">()</span>

</div></div>
<div class="viewcode-block" id="DEFINE_multi"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_multi">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_multi</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span>
                 <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a generic MultiFlag that parses its args with a given parser.</span>

<span class="sd">  Auxiliary function.  Normal users should NOT use it directly.</span>

<span class="sd">  Developers who need to create their own &#39;Parser&#39; classes for options</span>
<span class="sd">  which can appear multiple times can call this module function to</span>
<span class="sd">  register their flags.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">DEFINE_flag</span><span class="p">(</span><span class="n">MultiFlag</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">),</span>
              <span class="n">flag_values</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="DEFINE_multistring"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_multistring">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_multistring</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a flag whose value can be a list of any strings.</span>

<span class="sd">  Use the flag on the command line multiple times to place multiple</span>
<span class="sd">  string values into the list.  The &#39;default&#39; may be a single string</span>
<span class="sd">  (which will be converted into a single-element list) or a list of</span>
<span class="sd">  strings.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">parser</span> <span class="o">=</span> <span class="n">ArgumentParser</span><span class="p">()</span>
  <span class="n">serializer</span> <span class="o">=</span> <span class="n">ArgumentSerializer</span><span class="p">()</span>
  <span class="n">DEFINE_multi</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="DEFINE_multi_int"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_multi_int">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_multi_int</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                     <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a flag whose value can be a list of arbitrary integers.</span>

<span class="sd">  Use the flag on the command line multiple times to place multiple</span>
<span class="sd">  integer values into the list.  The &#39;default&#39; may be a single integer</span>
<span class="sd">  (which will be converted into a single-element list) or a list of</span>
<span class="sd">  integers.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">parser</span> <span class="o">=</span> <span class="n">IntegerParser</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
  <span class="n">serializer</span> <span class="o">=</span> <span class="n">ArgumentSerializer</span><span class="p">()</span>
  <span class="n">DEFINE_multi</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="DEFINE_multi_float"><a class="viewcode-back" href="../../lib.html#lib.gflags.DEFINE_multi_float">[docs]</a><span class="k">def</span> <span class="nf">DEFINE_multi_float</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">flag_values</span><span class="o">=</span><span class="n">FLAGS</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Registers a flag whose value can be a list of arbitrary floats.</span>

<span class="sd">  Use the flag on the command line multiple times to place multiple</span>
<span class="sd">  float values into the list.  The &#39;default&#39; may be a single float</span>
<span class="sd">  (which will be converted into a single-element list) or a list of</span>
<span class="sd">  floats.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">parser</span> <span class="o">=</span> <span class="n">FloatParser</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
  <span class="n">serializer</span> <span class="o">=</span> <span class="n">ArgumentSerializer</span><span class="p">()</span>
  <span class="n">DEFINE_multi</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">serializer</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">help</span><span class="p">,</span> <span class="n">flag_values</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>


<span class="c"># Now register the flags that we want to exist in all applications.</span>
<span class="c"># These are all defined with allow_override=1, so user-apps can use</span>
<span class="c"># these flagnames for their own purposes, if they want.</span></div>
<span class="n">DEFINE_flag</span><span class="p">(</span><span class="n">HelpFlag</span><span class="p">())</span>
<span class="n">DEFINE_flag</span><span class="p">(</span><span class="n">HelpshortFlag</span><span class="p">())</span>
<span class="n">DEFINE_flag</span><span class="p">(</span><span class="n">HelpXMLFlag</span><span class="p">())</span>

<span class="c"># Define special flags here so that help may be generated for them.</span>
<span class="c"># NOTE: Please do NOT use _SPECIAL_FLAGS from outside this module.</span>
<span class="n">_SPECIAL_FLAGS</span> <span class="o">=</span> <span class="n">FlagValues</span><span class="p">()</span>


<span class="n">DEFINE_string</span><span class="p">(</span>
    <span class="s">&#39;flagfile&#39;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
    <span class="s">&quot;Insert flag definitions from the given file into the command line.&quot;</span><span class="p">,</span>
    <span class="n">_SPECIAL_FLAGS</span><span class="p">)</span>

<span class="n">DEFINE_string</span><span class="p">(</span>
    <span class="s">&#39;undefok&#39;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
    <span class="s">&quot;comma-separated list of flag names that it is okay to specify &quot;</span>
    <span class="s">&quot;on the command line even if the program does not define a flag &quot;</span>
    <span class="s">&quot;with that name.  IMPORTANT: flags in this list that have &quot;</span>
    <span class="s">&quot;arguments MUST use the --flag=value format.&quot;</span><span class="p">,</span> <span class="n">_SPECIAL_FLAGS</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/ampush-logo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">Hermes</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Ampush.
    </div>
  </body>
</html>